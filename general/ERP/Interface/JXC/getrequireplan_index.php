<?php
/*
版权归属:郑州单点科技软件有限公司;
联系方式:0371-69663266;
公司地址:河南郑州经济技术开发区第五大街经北三路通信产业园四楼西南;
公司简介:郑州单点科技软件有限公司位于中国中部城市-郑州,成立于2007年1月,致力于把基于先进信息技术（包括通信技术）的最佳管理与业务实践普及到教育行业客户的管理与业务创新活动中，全面提供具有自主知识产权的教育管理软件、服务与解决方案，是中部最优秀的高校教育管理软件及中小学校管理软件提供商。目前己经有多家高职和中职类院校使用通达中部研发中心开发的软件和服务;

软件名称:单点科技软件开发基础性架构平台,以及在其基础之上扩展的任何性软件作品;
发行协议:数字化校园产品为商业软件,发行许可为LICENSE方式;单点CRM系统即SunshineCRM系统为GPLV3协议许可,GPLV3协议许可内容请到百度搜索;
特殊声明:软件所使用的ADODB库,PHPEXCEL库,SMTARY库归原作者所有,余下代码沿用上述声明;
*/

echo "<?php";
echo "    require_once('lib.inc.php');        \$GLOBAL_SESSION=returnsession();    \$ExecTimeBegin=getmicrotime();        if(\$_GET['action']==\"dataDeal\")\t\t\t{    \t//print_R(\$_GET);    \t//print_R(\$_POST);    \t//print_R(\$_SESSION);    \t\$tablecode = returnDateAutoIncrement(\"tablecode\",\"buyplanmain\");    \t\$tabledate = date(\"Y-m-d\");    \t//print \$tablecode.\"<HR>\";    \t\$USER_NAME = \$_SESSION['SUNSHINE_USER_NAME'];    \t\$NICK_NAME = \$_SESSION";
echo "['SUNSHINE_USER_NICK_NAME'];    \t\$stockid = \$_POST['stockid'];    \t\$supplyid = \$_POST['supplyId'];    \t\$amt = \$_POST['amt'];    \t\$factpayamt = \$_POST['factpayamt'];    \t\$state = \$_POST['state'];    \t\$intype = \$_POST['intype'];    \t\$chinaAmt = \$_POST['chinaAmt'];    \t\$chinaAmt = \$_POST['chinaAmt'];    \t\$chinaAmt = \$_POST['chinaAmt'];    \t\$state = '1';//\$_POST['state'];    \t\$intype = \$_POST['intype'];    \t\$sendDate = \$_POS";
echo "T['sendDate'];    \t\$stockinsign = \"来自于采购计划单\";    \t    \t\$sql = \"insert into buyplanmain (    \t\ttablecode,tabledate,stockinpersion,stockid,stockiplaceid,    \t\tsupplyid,amt,factpayamt,ROWID,user_id,    \t\tstate,intype,chinaAmt,buyman,sendDate,    \t\tpayamt,stockinsign)     \t\tvalues (     \t\t'\$tablecode','\$tabledate','\$USER_NAME', '\$stockid','',    \t\t'\$supplyid','\$amt','\$factpayamt','','\$USER_NAME',    \t\t'\$state','\$in";
echo "type','\$chinaAmt','\$NICK_NAME','\$sendDate',    \t\t'','\$stockinsign')\";    \t\$db->Execute(\$sql);    \t\$Insert_ID = \$db->Insert_ID();    \t//print \$sql.\"<HR>\";    \tfor(\$i=1;\$i<=\$_POST['num'];\$i++)\t\t{    \t\t\$backnum = \$_POST[\"backnum\".\$i];    \t\t\$backamt = \$_POST[\"backamt\".\$i];    \t\t\$backallamt = \$_POST[\"backallamt\".\$i];    \t\t\$tablecode = \$_POST[\"0\".\$i];    \t\t\$DEPT_NAME = \$_POST[\"1\".\$i];    \t\t\$tabledate = \$_POST[\"2\".\$i];    \t\t\$prod";
echo "uctid = \$_POST[\"3\".\$i];    \t\t\$productname = \$_POST[\"4\".\$i];    \t\t\$standard = \$_POST[\"5\".\$i];    \t\t\$mode = \$_POST[\"6\".\$i];    \t\t\$plannum = \$_POST[\"7\".\$i];    \t\t\$stockinfactnum = \$_POST[\"8\".\$i];    \t\t\$price = \$_POST[\"9\".\$i];    \t\t\$requireplandetailsign = \$_POST[\"10\".\$i];    \t\t\$ROWID = \$_POST[\"ROWID_\".\$i];    \t\t    \t\t//\$ordercode = \$_POST['ordercode'];    \t\t    \t\t//当时流转数据不为0时，转换采购计划明细到采购订单。    \t\tif(\$ba";
echo "cknum!=\"\")\t\t{    \t\t\t\$sql = \"insert into buyplandetail (    \t\t\tproductid,plannum,stockinfactnum,price,money,    \t\t\tmainrowid,standard,mode,ordercode    \t\t\t) values (     \t\t\t'\$productid','\$backnum','\$stockinfactnum', '\$price','\$money',    \t\t\t'\$Insert_ID','\$standard','\$mode','\$ordercode')\";    \t\t\t\$db->Execute(\$sql);    \t\t\t//print \$sql.\"<HR>\";    \t\t\t    \t\t\t//修改采购计划明细的数据状态为部分执行    \t\t\t\$update = \"update requi";
echo "replandetail set dataState ='1',stockinfactnum=stockinfactnum+'\$backnum' where ROWID='\$ROWID'\";    \t\t\t\$db->Execute(\$update);    \t\t\t//print \$update.\"<HR>\";        \t\t\t//修改采购计划主表的数据状态为部分执行    \t\t\t\$MAINROWID = returntablefield(\"requireplandetail\",\"ROWID\",\$ROWID,\"mainrowid\");    \t\t\t\$update = \"update requireplanmain set dataState ='1' where ROWID='\$MAINROWID'\";    \t\t\t\$db->Execute(\$update);    \t\t\t//print";
echo " \$update.\"<HR>\";        \t\t\t//判断主表里面的数据是否完全执行    \t\t\t\$udpate = \"select distinct mainrowid from requireplandetail where (dataState!='2' and stockinfactnum>=plannum) and mainrowid='\$MAINROWID'\";    \t\t\t\$rs = \$db->Execute(\$udpate);    \t\t\t//print \$udpate.\"<HR>\";    \t\t\t\$rs_a = \$rs->GetArray();\t//print_R(\$rs_a);    \t\t\t\$mainrowid = \$rs_a[0]['mainrowid'];    \t\t\tif(\$mainrowid!=\"\")\t\t{    \t\t\t\t\$update = \"update requi";
echo "replanmain set dataState ='2' where ROWID='\$MAINROWID'\";    \t\t\t\t\$db->Execute(\$update);    \t\t\t\t//print \$udpate.\"<HR>\";    \t\t\t}    \t\t}        \t\t        \t}    \t//如果采购计划明细部分数据流转完成，更新dataState为2。部分流转显示未全部执行，更新为1    \t\$udpate = \"update requireplandetail set dataState ='2' where stockinfactnum>=plannum\";    \t\$db->Execute(\$udpate);    \t//print \$udpate.\"<HR>\";        \t    }        \t\t    ?>            \t        <link rel=";
echo "\"stylesheet\" type=\"text/css\" href=\"".ROOT_DIR."theme/3/style.css\">                <div style=\"position:absolute;width:322;height:14;border:1 #707888 solid;overflow:hidden\" id=\"pinghead\">    \t<div style=\"position:absolute;top:-1;left:0\" id=\"pimg\">    \t</div>    </div>    <center>    <div  style=\"position:absolute;top:30;left:120;font-size:9pt;color:#f4f4f4\" id=\"abc\">    正在从服务器读取数据，请稍等........    </div>    </center>    ";
echo "<s";
echo "cript>    s=new Array();    s[0]=\"#050626\";    s[1]=\"#0a0b44\";    s[2]=\"#0f1165\";    s[3]=\"#1a1d95\";    s[4]=\"#1c1fa7\";    s[5]=\"#1c20c8\";    s[6]=\"#060cff\";    s[7]=\"#2963f8\";    function ls(){    \t\tpimg.innerHTML=\"\";    \t\tfor(i=0;i<9;i++){    \t\tpimg.innerHTML+=\"<input style=\\\"width:15;height:10;border:0;background:\"+s[i]+\";margin:1\\\">\";    \t\t}    \t}    \t    function rs(){    \t\tpimg.innerHTML=\"\";    \t\tfor(i=9;i>-1;i--){    \t\tpimg.innerHT";
echo "ML+=\"<input style=\\\"width:15;height:10;border:0;background:\"+s[i]+\";margin:1\\\">\";    \t\t}    \t}    \t    ls();    var g=0;sped=0;    function str(){    \tif(pimg.style.pixelLeft<350&&g==0){    \tif(sped==0){    \t\tls();    \t\tsped=1;    \t\t}    \tpimg.style.pixelLeft+=2;    \tsetTimeout(\"str()\",1);    \treturn;    \t}    \tg=1;    \tif(pimg.style.pixelLeft>-200&&g==1){    \tif(sped==1){    \t\trs();    \t\tsped=0;    \t\t}    \tpimg.style.pixelLeft-=2;    \tsetTimeo";
echo "ut(\"str()\",1);    \treturn;    \t}    \tg=0;    \tstr();    }        function flashs(){    if(abc.style.color==\"#ffffff\"){    \tabc.style.color=\"#707888\";    \tsetTimeout('flashs()',500);    \t}    else{    \tabc.style.color=\"#ffffff\";    \tsetTimeout('flashs()',500);    \t}    }    flashs();    str();    </script>    ";
echo "<s";
echo "cript>    var now1 =new Date()    StarTime_S=now1.getTime()    </script>                                        \t                ";
echo "<s";
echo "cript language=\"javascript\">    function click() {    if (event.button==2) {    alert('欢迎使用通达进销存。如需技术支持与服务，请联系开发商中国兵器工业信息中心通达科技01068964532。')    }    }        </script>                                    ";
echo "<s";
echo "cript language=javascript>    var amtdot='0';    if  (amtdot==\"\"||amtdot==null){    \tamtdot=2;    \t}    function mult_Select(rowId)    {      var idStr=document.all(\"rowId_STR\").value;            if (idStr==\"\")      {      idStr=rowId+\"|\";      }      else      {      if(idStr.search(rowId)!=-1)      {         idStr=idStr.replace(rowId+\"|\",\"\");      }       else      idStr=idStr+rowId+\"|\";\t      }      //alert(idStr);      document.all(\"rowId";
echo "_STR\").value=idStr;          }        function converUrlStr(urlStr) {        var reArray = new Array(        /[%]{1}/g,        /[#]{1}/g,            /[&]{1}/g,          /[+]{1}/g,        /[\\\\]{1}/g,        /[=]{1}/g,        /[?]{1}/g      );      var strArray = new Array(        \"%25\",        \"%23\",            \"%26\",        \"%2B\",        \"%2F\",        \"%3D\",        \"%3F\"      );      var newStr = urlStr;      for (var i = 0; i < reArray.length; ";
echo "i++) {        var newStr = newStr.replace(reArray[i], strArray[i]);      }      return newStr;    }    function mult_Select(rowId)    {      var idStr=document.all(\"rowId_STR\").value;            if (idStr==\"\")      {      idStr=rowId+\"|\";      }      else      {      if(idStr.search(rowId)!=-1)      {         idStr=idStr.replace(rowId+\"|\",\"\");      }       else      idStr=idStr+rowId+\"|\";\t      }      //alert(idStr);      document.all(\"rowId_";
echo "STR\").value=idStr;          }    function value_empty(fld_must,fld_name)    {       fld_str_obj=document.all(fld_must);       name_str_obj=document.all(fld_name);       if(fld_str_obj.value==\"\")          return false;           fld_array=fld_str_obj.value.split(\",\");       name_array=name_str_obj.value.split(\",\");           for(i=0;i<=fld_array.length;i++)       {         if(fld_array[i]==\"\")            break;         fld_obj=docum";
echo "ent.all(fld_array[i]);         if(fld_obj.value==\"\")         {           alert(\"〖\"+name_array[i]+\"〗不能为空！\");           if(fld_obj.readonly==\"\")             fld_obj.focus();             return (true);         }       }       return (false);    }        function find_id(theId,idStr)    {    \t//alert(\"theId\"+theId);    \t//alert(\"idStr\"+idStr);       if(theId==\"\" || idStr==\"\")          return false;       if(idStr.search(theId)==-";
echo "1)          return false;       return true;    }        function add(openurl)    {       loc_x=300;       loc_y=200;    window.open(openurl,\"qqq\",\"menubar=0,toolbar=0,status=0,scrollbars=1,resizable=1,width=400px,height=150px,Top=\"+loc_y+\"px,Left=\"+loc_x+\"px\");    }    function secadd(openurl)    {       loc_x=300;       loc_y=200;    window.open(openurl,\"qqq\",\"menubar=0,toolbar=0,status=0,scrollbars=1,resizable=1,width=900px";
echo ",height=450px,Top=\"+loc_y+\"px,Left=\"+loc_x+\"px\");    }    //修改--夏勇    function order()    {      var ModuleId=document.all(\"ModuleId\").value;      URL=\"/order.jsp?ModuleId=\"+ModuleId;      loc_x=150;      loc_y=100;      //window.showModalDialog(URL,self,\"edge:raised;scroll:0;status:0;help:0;resizable:1;dialogWidth:700px;dialogHeight:450px;dialogTop:\"+loc_y+\"px;dialogLeft:\"+loc_x+\"px\");      //window.open(URL,\"11";
echo "\",\"edge:raised;scroll:0;status:0;help:0;resizable:1;dialogWidth:400px;dialogHeight:350px;dialogTop:\"+loc_y+\"px;dialogLeft:\"+loc_x+\"px\");      window.open(URL,\"qqq\",\"menubar=0,toolbar=0,status=0,scrollbars=1,resizable=1,width=700px,height=450px,Top=\"+loc_y+\"px,Left=\"+loc_x+\"px\");        }    function selectMan(ModuleId)    {    \t var idStr=document.all(\"ID_STR\").value;    \t        if(idStr==\"\")       {          alert(";
echo "\"请选中一项！\");          return false;       }       if(idStr.indexOf(\",\") < idStr.length-1)       {          alert(\"只能选中一项！\");          return false;       }      idStr=idStr.substring(0,idStr.indexOf(\",\"));      URL=\"/inflow/index/orderprod.jsp?ModuleId=\"+idStr;      loc_x=150;      loc_y=100;      //window.showModalDialog(URL,self,\"edge:raised;scroll:0;status:0;help:0;resizable:1;dialogWidth:700px;dialogHeight:";
echo "450px;dialogTop:\"+loc_y+\"px;dialogLeft:\"+loc_x+\"px\");      //window.open(URL,\"11\",\"edge:raised;scroll:0;status:0;help:0;resizable:1;dialogWidth:400px;dialogHeight:350px;dialogTop:\"+loc_y+\"px;dialogLeft:\"+loc_x+\"px\");      window.open(URL,\"qqq\",\"menubar=0,toolbar=0,status=0,scrollbars=1,resizable=1,width=700px,height=450px,Top=\"+loc_y+\"px,Left=\"+loc_x+\"px\");        }    function selectField(ModuleId)    {    \t v";
echo "ar idStr=document.all(\"ID_STR\").value;    \t        if(idStr==\"\")       {          alert(\"请选中一项！\");          return false;       }       if(idStr.indexOf(\",\") < idStr.length-1)       {          alert(\"只能选中一项！\");          return false;       }      idStr=idStr.substring(0,idStr.indexOf(\",\"));      URL=\"/inflow/index/orderfield.jsp?FolderID=\"+idStr+\"&ModuleId=\"+ModuleId;      loc_x=150;      loc_y=100;      //window.sho";
echo "wModalDialog(URL,self,\"edge:raised;scroll:0;status:0;help:0;resizable:1;dialogWidth:700px;dialogHeight:450px;dialogTop:\"+loc_y+\"px;dialogLeft:\"+loc_x+\"px\");      //window.open(URL,\"11\",\"edge:raised;scroll:0;status:0;help:0;resizable:1;dialogWidth:400px;dialogHeight:350px;dialogTop:\"+loc_y+\"px;dialogLeft:\"+loc_x+\"px\");      window.open(URL,\"qqq\",\"menubar=0,toolbar=0,status=0,scrollbars=1,resizable=1,wi";
echo "dth=700px,height=450px,Top=\"+loc_y+\"px,Left=\"+loc_x+\"px\");        }    function lookquery(ModuleId)    {      URL=\"/module/combquery/index.jsp?ModuleId=\"+ModuleId;      loc_x=400;      loc_y=150;      //window.showModalDialog(URL,self,\"edge:raised;scroll:0;status:0;help:0;resizable:1;dialogWidth:400px;dialogHeight:150px;dialogTop:\"+loc_y+\"px;dialogLeft:\"+loc_x+\"px\");      //window.open(URL,\"11\",\"edge:raised;scroll:";
echo "0;status:0;help:0;resizable:1;dialogWidth:400px;dialogHeight:350px;dialogTop:\"+loc_y+\"px;dialogLeft:\"+loc_x+\"px\");      window.open(URL,\"qqq\",\"menubar=0,toolbar=0,status=0,scrollbars=1,resizable=1,width=500px,height=150px,Top=\"+loc_y+\"px,Left=\"+loc_x+\"px\");        }    function lookhelp(ModuleId,ModuleActionId)    {      URL=\"/module/helpquery/index.jsp?ModuleId=\"+ModuleId+\"&ModuleActionId=\"+ModuleActionId;    ";
echo "  loc_x=400;      loc_y=150;      //window.showModalDialog(URL,self,\"edge:raised;scroll:0;status:0;help:0;resizable:1;dialogWidth:400px;dialogHeight:150px;dialogTop:\"+loc_y+\"px;dialogLeft:\"+loc_x+\"px\");      //window.open(URL,\"11\",\"edge:raised;scroll:0;status:0;help:0;resizable:1;dialogWidth:400px;dialogHeight:350px;dialogTop:\"+loc_y+\"px;dialogLeft:\"+loc_x+\"px\");      window.open(URL,\"qqq\",\"menubar=0,tool";
echo "bar=0,status=0,scrollbars=1,resizable=1,width=500px,height=550px,Top=\"+loc_y+\"px,Left=\"+loc_x+\"px\");        }    function data_out(ModuleId,ModuleName)    {      URL=\"/export.jsp?ModuleId=\"+ModuleId+\"&ModuleName=\"+ModuleName;      loc_x=450;      loc_y=250;      window.open(URL,\"qqq\",\"menubar=0,toolbar=0,status=0,scrollbars=1,resizable=1,width=300px,height=250px,Top=\"+loc_y+\"px,Left=\"+loc_x+\"px\");    }    function da";
echo "ta_select(ModuleId,ModuleName)    {      URL=\"/setSql.jsp\";      loc_x=450;      loc_y=250;      window.showModalDialog(URL,self,\"edge:raised;scroll:0;status:0;help:0;resizable:1;dialogWidth:400px;dialogHeight:350px;dialogTop:\"+loc_y+\"px;dialogLeft:\"+loc_x+\"px\");      //window.open(URL,\"qqq\",\"menubar=0,toolbar=0,status=0,scrollbars=1,resizable=1,width=350px,height=450px,Top=\"+loc_y+\"px,Left=\"+loc_x+\"px\");    }\r";
echo "\nfunction data_query(ModuleId,ModuleName)    {      URL=\"/query.jsp?ModuleId=\"+ModuleId+\"&ModuleName=\"+ModuleName;      loc_x=450;      loc_y=250;      window.showModalDialog(URL,self,\"edge:raised;scroll:0;status:0;help:0;resizable:1;dialogWidth:400px;dialogHeight:150px;dialogTop:\"+loc_y+\"px;dialogLeft:\"+loc_x+\"px\");      //window.open(URL,\"qqq\",\"menubar=0,toolbar=0,status=0,scrollbars=1,resizable=1,width=300";
echo "px,height=250px,Top=\"+loc_y+\"px,Left=\"+loc_x+\"px\");    }    function edit(openrul)    {       var idStr=document.all(\"ID_STR\").value;       //var idRowid=idStr.substring(0,18)+\",\";       var idStr2=idStr.substring(0,idStr.length-1);       //alert(idStr2);       if (document.getElementById(\"NotDel_\"+idStr2)!=null){       var NotDel=document.all(\"NotDel_\"+idStr2).value;       //alert(NotDel);       if(NotDel==\"1\")       {\r";
echo "\n      alert(\"系统设置参数，无法修改！\");          return false;       }      }              if(idStr==\"\")       {          alert(\"请选中一项编辑！\");          return false;       }       if(idStr.indexOf(\",\") < idStr.length-1)       {          alert(\"只能选中一项编辑！\");          return false;       }       URL=openrul+\"?rowid=\"+idStr;       loc_x=300;       loc_y=200;    window.open(URL,\"\",\"menubar=0,toolbar=0,status=0,scrollbars=";
echo "1,resizable=1,width=400px,height=150px,Top=\"+loc_y+\"px,Left=\"+loc_x+\"px\");    }    function secedit(openrul)    {       var idStr=document.all(\"ID_STR\").value;       var idRowid=idStr.substring(0,18)+\",\";       if(idStr==\"\")       {          alert(\"请选中一项编辑！\");          return false;       }       if(idStr.indexOf(\",\") < idStr.length-1)       {          alert(\"只能选中一项编辑！\");          return false;       }       URL=";
echo "openrul+\"?rowid=\"+idStr;       loc_x=100;       loc_y=200;    window.open(URL,\"\",\"menubar=0,toolbar=0,status=0,scrollbars=1,resizable=1,width=800px,height=450px,Top=\"+loc_y+\"px,Left=\"+loc_x+\"px\");    }        function bathedit(openrul)    {       var idStr=document.all(\"ID_STR\").value;       var idRowid=idStr.substring(0,18)+\",\";       if(idStr==\"\")       {          alert(\"请选中一项编辑！\");          return false;       }    ";
echo "          URL=openrul+\"?rowid=\"+idStr;       loc_x=300;       loc_y=200;    window.open(URL,\"\",\"menubar=0,toolbar=0,status=0,scrollbars=1,resizable=1,width=400px,height=150px,Top=\"+loc_y+\"px,Left=\"+loc_x+\"px\");    }    function voucher(openrul)    {       var idStr=document.all(\"rowId_STR\").value;       //  var idStr=document.all(\"rowId_STR\").value;       //var idRowid=idStr.substring(0,18)+\",\";       alert(idStr);      ";
echo " var tableStr=document.all(\"A_Table\").value;       if(idStr==\"\")       {          alert(\"请选中一项生成凭证！\");          return false;       }       idStr=converUrlStr(idStr);       //idStr=idStr.replace(\"+\",\"%2B\");       //if(idStr.indexOf(\",\") < idStr.length-1)       //{       //   alert(\"只能选中一项生成凭证！\");       //   return false;       //}       alert(idStr);       URL=openrul+\"?rowid=\"+idStr+\"&A_Table=\"+tableStr;";
echo "       alert(URL);       loc_x=150;       loc_y=100;        window.open(URL,\"\",\"menubar=0,toolbar=0,status=0,scrollbars=1,resizable=1,width=900px,height=550px,Top=\"+loc_y+\"px,Left=\"+loc_x+\"px\");    }    function editvoucher(openrul,rowid)    {       var idRowid=rowid.substring(0,18)+\",\";       URL=openrul+\"?rowid=\"+idRowid;           loc_x=150;       loc_y=100;        window.open(URL,\"\",\"menubar=0,toolbar=0,status=0,scrollbars";
echo "=1,resizable=1,width=900px,height=470px,Top=\"+loc_y+\"px,Left=\"+loc_x+\"px\");    }    function voucheredit(openrul)    {       var idStr=document.all(\"ID_STR\").value;       //alert(idStr);       var idRowid=idStr.substring(0,18)+\",\";       var tableStr=document.all(\"A_Table\").value;       if(idStr==\"\")       {          alert(\"请选中一项编辑凭证！\");          return false;       }       if(idStr.indexOf(\",\") < idStr.length-1)\r";
echo "\n   {          alert(\"只能选中一项编辑凭证！\");          return false;       }           URL=openrul+\"?rowid=\"+idRowid+\"&A_Table=\"+tableStr;     //  alert(tableStr);       loc_x=150;       loc_y=100;        window.open(URL,\"\",\"menubar=0,toolbar=0,status=0,scrollbars=1,resizable=1,width=900px,height=470px,Top=\"+loc_y+\"px,Left=\"+loc_x+\"px\");    }        function del()    {       var idStr=document.all(\"ID_STR\").value;       var Mo";
echo "duleId=document.all(\"ModuleId\").value;       var userIdStr=document.all(\"userIdStr\").value;       var idStr2=idStr.substring(0,idStr.length-1);       //alert(idStr2);       if (document.getElementById(\"NotDel_\"+idStr2)!=null){       var NotDel=document.all(\"NotDel_\"+idStr2).value;       //alert(NotDel);       if(NotDel==\"1\")       {          alert(\"系统设置参数，无法删除！\");          return false;       }      }       if(";
echo "idStr==\"\")       {          alert(\"请至少选中一项删除！\");          return false;       }           if(!window.confirm(\"确定删除吗？\"))          return false;       //alert(idStr);       Qform1.qflag.value=\"delete\";       Qform1.deletevalue.value=idStr;       Qform1.submit();    }    function refer()    {       var idStr=document.all(\"ID_STR\").value;       if(idStr==\"\")       {          alert(\"请至少选中一项进行提交！\");          retu";
echo "rn false;       }       if(!window.confirm(\"确定提交审批吗？\"))          return false;       Qform1.qflag.value=\"refer\";       Qform1.deletevalue.value=idStr;       Qform1.updateStateId.value=\"2\";       Qform1.submit();    }    function referPass()    {       var idStr=document.all(\"ID_STR\").value;       if(idStr==\"\")       {          alert(\"请至少选中一项进行审批！\");          return false;       }       if(!window.confirm(\"确定\"))          return false;       Qform1.qflag.value=\"refer\";       Qform1.deletevalue.value=idStr;       Qform1.updateStateId.value=\"3\";       Qform1.submit();    }    function referReject()    {       var idStr=document.all(\"ID_STR\").value;       if(idStr==\"\")       {          alert(\"请至少选中一项进行驳回！\");          return false;       }       if(!window.confirm(\"确定审批驳回吗？\"))          return false;       Qfo";
echo "rm1.qflag.value=\"refer\";       Qform1.deletevalue.value=idStr;       Qform1.updateStateId.value=\"5\";       Qform1.submit();    }    function delvou()    {       var idStr=document.all(\"ID_STR\").value;       var idRowid=idStr.substring(0,18)+\",\";       if(idStr==\"\")       {          alert(\"请至少选中一项删除！\");          return false;       }           if(!window.confirm(\"确定删除吗？\"))          return false;           Qform1.qflag";
echo ".value=\"deleteandvoucher\";       Qform1.deletevalue.value=idRowid;       Qform1.submit();    }    function query()    {       Qform1.qflag.value=\"query\";       //alert(\"11111111111\");       Qform1.submit();    }    function addnew()    {       if(value_empty(\"FLD_MUST_STR\",\"FLD_NAME_STR\"))          return (false);       form1.flag.value=\"addnew\";       form1.submit();    }        function balance()    {       //if(value_empty(\"GRP_NO,UN";
echo "IT_ID,\",\"FLD_NAME_STR\"))         //return (false);           form1.flag.value=\"balance\";       form1.submit();    }    function update()    {       if(value_empty(\"FLD_MUST_STR\",\"FLD_NAME_STR\"))          return (false);           form1.flag.value=\"update\";       form1.submit();    }    function updateDelete()    {              form1.flag.value=\"deleteLev\";              form1.submit();    }    function delLeverList()    {    \t//alert(\"测试\");\r";
echo "\n\tvar idStr=parent.dept_main.form1.ID_STR.value;        \tif (idStr==null){    \t\tidStr=\"\";    \t\t}      if (idStr==\"\") {      \talert(\"请选择要删除的数据！\");      \treturn;      \t}       form1.ID_STR.value=idStr;         form1.flag.value=\"deleteLevList\";          form1.submit();    }    function updatevou()    {       if(value_empty(\"FLD_MUST_STR\",\"FLD_NAME_STR\"))          return (false);       //alert(\"123\");       form1.flag.value=\"u";
echo "pdatevoucher\";       form1.submit();    }        function update2()    {           form1.flag.value=\"updatevoucher\";       //alert(\"123\");       form1.submit();    }    function update3()    {       form1.flag.value=\"editvoucher\";       //alert(\"123\");       form1.submit();    }    var theDefaultColor=\"#FFFFFF\";    var thePointerColor=\"#D9E8FF\";    var theMarkColor=\"#003FBF\";    function setKeyId(){    \tdocument.all(\"keyId\").value=event.k";
echo "eyCode;    }    function retKeyId(){    \tdocument.all(\"keyId\").value=\"\";    }        function setPointer(theRow, theId, theAction)    {    \t //var theCells = null;       var idStr=document.all(\"ID_STR\").value;       theId+=\",\";              var keyId=document.all(\"keyId\").value;                   \tif (keyId == 16){//shift键 相邻选择       \t        }else if (keyId == 17){//ctrl键  单个挑选        \t  if(theAction==\"over\" && !find_id(t";
echo "heId,idStr)){          //theRow.style.background=thePointerColor;        }       else if(theAction==\"out\" && !find_id(theId,idStr)){          theRow.style.background=theDefaultColor;        }       else if(theAction==\"click\")       {          if(find_id(theId,idStr))          {          \t//alert(\"相等\");             idStr=idStr.replace(theId,\"\");             theRow.style.background=thePointerColor;             theRow.style";
echo ".color=\"#000000\";          }          else          {            //alert(\"不相等\");             if(idStr!=\"\"&&document.all(\"TR\"+idStr.replace(\",\",\"\"))!=null)             {             \t//alert(\"是否选中颜色\");                //document.all(\"TR\"+idStr.replace(\",\",\"\")).style.background=theDefaultColor;                //document.all(\"TR\"+idStr.replace(\",\",\"\")).style.color=\"#000000\";             }             idStr+=theId;";
echo "             theRow.style.background=theMarkColor;             theRow.style.color=\"#FFFFFF\";          }                document.all(\"ID_STR\").value=idStr;              }        }        else{    \t        \t        \t  if(theAction==\"over\" && theId!=idStr && !find_id(theId,idStr) ){          //theRow.style.background=thePointerColor;        }       else if(theAction==\"out\" && theId!=idStr && !find_id(theId,idStr) ){          ";
echo "//theRow.style.background=theDefaultColor;        }       else if(theAction==\"click\")       {        \tif(theId==idStr)          {          \t             idStr=\"\";                          theRow.style.background=thePointerColor;             theRow.style.color=\"#000000\";          }          else          {          \t             if(idStr!=\"\"&&document.all(\"TR\"+idStr.replace(\",\",\"\"))!=null)             {             \t               do";
echo "cument.all(\"TR\"+idStr.replace(\",\",\"\")).style.background=theDefaultColor;               document.all(\"TR\"+idStr.replace(\",\",\"\")).style.color=\"#000000\";             }             idStr=theId;             theRow.style.background=theMarkColor;             theRow.style.color=\"#FFFFFF\";          }     \t     \t  //清除idStr最后的\",\"号 -- 夏勇    \t  /*    \t  if (idStr.charAt(idStr.length-1)== ',')      \t  {    \t\t  alert(\"fda\");    ";
echo "\t\t  idStr = idStr.substr(0, idStr.length-1);    \t  }*/          document.all(\"ID_STR\").value=idStr;              }        \t}        }        function query_code(field)    {      //alert(field);      init_value=document.all(field).value;      code=document.all(field+\"_CODE\").value;      table=document.all(field+\"_TABLE\").value;      URL=\"/query/index.jsp?CODE=\"+code+\"&TABLE=\"+table+\"&FIELD=\"+field+\"&INIT_VALUE=\"+init_value;    ";
echo "  loc_x=document.body.scrollLeft+event.clientX-event.offsetX+350;      loc_y=document.body.scrollTop+event.clientY-event.offsetY+100;      window.showModalDialog(URL,self,\"edge:raised;scroll:0;status:0;help:0;resizable:1;dialogWidth:450px;dialogHeight:250px;dialogTop:\"+loc_y+\"px;dialogLeft:\"+loc_x+\"px\");      //window.open(URL,\"\",\"menubar=0,toolbar=0,status=0,scrollbars=1,resizable=1,width=400px,height=";
echo "300px,Top=\"+loc_y+\"px,Left=\"+loc_x+\"px\");    }        function query_user(field)    {      init_value=document.all(field).value;      code=\"1\";      table=\"user\";      URL=\"/queryuser/index.jsp?CODE=\"+code+\"&TABLE=\"+table+\"&FIELD=\"+field+\"&INIT_VALUE=\"+init_value;      loc_x=document.body.scrollLeft+event.clientX-event.offsetX+350;      loc_y=document.body.scrollTop+event.clientY-event.offsetY+100;      window.showModa";
echo "lDialog(URL,self,\"edge:raised;scroll:0;status:0;help:0;resizable:1;dialogWidth:450px;dialogHeight:250px;dialogTop:\"+loc_y+\"px;dialogLeft:\"+loc_x+\"px\");      //window.open(URL,\"\",\"menubar=0,toolbar=0,status=0,scrollbars=1,resizable=1,width=400px,height=300px,Top=\"+loc_y+\"px,Left=\"+loc_x+\"px\");    }    function query_userid(field)    {      init_value=document.all(field).value;      code=\"1\";      table=\"user\";    ";
echo "  URL=\"/queryuserid/index.jsp?CODE=\"+code+\"&TABLE=\"+table+\"&FIELD=\"+field+\"&INIT_VALUE=\"+init_value;      loc_x=document.body.scrollLeft+event.clientX-event.offsetX+350;      loc_y=document.body.scrollTop+event.clientY-event.offsetY+100;      window.showModalDialog(URL,self,\"edge:raised;scroll:0;status:0;help:0;resizable:1;dialogWidth:450px;dialogHeight:250px;dialogTop:\"+loc_y+\"px;dialogLeft:\"+loc_x+\"px";
echo "\");      //window.open(URL,\"\",\"menubar=0,toolbar=0,status=0,scrollbars=1,resizable=1,width=400px,height=300px,Top=\"+loc_y+\"px,Left=\"+loc_x+\"px\");    }    function query_bath(field)    {      //alert(field);      init_value=document.all(field).value;      code=document.all(field+\"_CODE\").value;      table=document.all(field+\"_TABLE\").value;      URL=\"/bathquery/index.jsp?CODE=\"+code+\"&TABLE=\"+table+\"&FIELD=\"+field+\"";
echo "&INIT_VALUE=\"+init_value;      loc_x=document.body.scrollLeft+event.clientX-event.offsetX+350;      loc_y=document.body.scrollTop+event.clientY-event.offsetY+100;      window.showModalDialog(URL,self,\"edge:raised;scroll:0;status:0;help:0;resizable:1;dialogWidth:300px;dialogHeight:250px;dialogTop:\"+loc_y+\"px;dialogLeft:\"+loc_x+\"px\");      //window.open(URL,\"\",\"menubar=0,toolbar=0,status=0,scrollbars=1,resi";
echo "zable=1,width=400px,height=300px,Top=\"+loc_y+\"px,Left=\"+loc_x+\"px\");    }    function query_two(field)    {      //alert(field);      init_value=document.all(field).value;      code=document.all(field+\"_CODE\").value;      table=document.all(field+\"_TABLE\").value;      URL=\"/lever/code/query/index.jsp?CODE=\"+code+\"&TABLE=\"+table+\"&FIELD=\"+field+\"&INIT_VALUE=\"+init_value;      loc_x=document.body.scrollLeft+event.cli";
echo "entX-event.offsetX+350;      loc_y=document.body.scrollTop+event.clientY-event.offsetY+100;      window.showModalDialog(URL,self,\"edge:raised;scroll:0;status:0;help:0;resizable:1;dialogWidth:300px;dialogHeight:250px;dialogTop:\"+loc_y+\"px;dialogLeft:\"+loc_x+\"px\");      //window.open(URL,\"\",\"menubar=0,toolbar=0,status=0,scrollbars=1,resizable=1,width=400px,height=300px,Top=\"+loc_y+\"px,Left=\"+loc_x+\"px\");\r";
echo "\n}    function query_acct(field)    {      //alert(field);      init_value=document.all(field).value;      code=document.all(field+\"_CODE\").value;      table=document.all(field+\"_TABLE\").value;      URL=\"/queryacct/index.jsp?CODE=\"+code+\"&TABLE=\"+table+\"&FIELD=\"+field+\"&INIT_VALUE=\"+init_value;      loc_x=document.body.scrollLeft+event.clientX-event.offsetX+350;      loc_y=document.body.scrollTop+event.clientY-even";
echo "t.offsetY+100;      window.showModalDialog(URL,self,\"edge:raised;scroll:0;status:0;help:0;resizable:1;dialogWidth:300px;dialogHeight:250px;dialogTop:\"+loc_y+\"px;dialogLeft:\"+loc_x+\"px\");      //window.open(URL,\"\",\"menubar=0,toolbar=0,status=0,scrollbars=1,resizable=1,width=400px,height=300px,Top=\"+loc_y+\"px,Left=\"+loc_x+\"px\");    }        function query_ongrpno(field)    {      init_value=document.all(field).va";
echo "lue;      code=document.all(field+\"_CODE\").value;      table=document.all(field+\"_TABLE\").value;      URL=\"/ongrpnoquery/index.jsp?CODE=\"+code+\"&TABLE=\"+table+\"&FIELD=\"+field+\"&INIT_VALUE=\"+init_value;      //URL=\"/ongrpnoquery/index.jsp?FIELD=\"+field;      loc_x=document.body.scrollLeft+event.clientX-event.offsetX+350;      loc_y=document.body.scrollTop+event.clientY-event.offsetY+100;      window.showModalDia";
echo "log(URL,self,\"edge:raised;scroll:0;status:0;help:0;resizable:1;dialogWidth:350px;dialogHeight:250px;dialogTop:\"+loc_y+\"px;dialogLeft:\"+loc_x+\"px\");      //window.open(URL,\"\",\"menubar=0,toolbar=0,status=0,scrollbars=1,resizable=1,width=400px,height=300px,Top=\"+loc_y+\"px,Left=\"+loc_x+\"px\");    }        function query_ongrpno_exps(field)    {      init_value=document.all(field).value;      code=document.all(field+";
echo "\"_CODE\").value;      table=document.all(field+\"_TABLE\").value;      URL=\"/ongrpnoqueryexps/index.jsp?CODE=\"+code+\"&TABLE=\"+table+\"&FIELD=\"+field+\"&INIT_VALUE=\"+init_value;      //URL=\"/ongrpnoquery/index.jsp?FIELD=\"+field;      loc_x=document.body.scrollLeft+event.clientX-event.offsetX+350;      loc_y=document.body.scrollTop+event.clientY-event.offsetY+100;      window.showModalDialog(URL,self,\"edge:raised;sc";
echo "roll:0;status:0;help:0;resizable:1;dialogWidth:350px;dialogHeight:250px;dialogTop:\"+loc_y+\"px;dialogLeft:\"+loc_x+\"px\");      //window.open(URL,\"\",\"menubar=0,toolbar=0,status=0,scrollbars=1,resizable=1,width=400px,height=300px,Top=\"+loc_y+\"px,Left=\"+loc_x+\"px\");    }            function query_pay(field)    {      init_value=document.all(field).value;      code=document.all(field+\"_CODE\").value;      table=document.a";
echo "ll(field+\"_TABLE\").value;      URL=\"/payquery/index.jsp?CODE=\"+code+\"&TABLE=\"+table+\"&FIELD=\"+field+\"&INIT_VALUE=\"+init_value;      loc_x=document.body.scrollLeft+event.clientX-event.offsetX+350;      loc_y=document.body.scrollTop+event.clientY-event.offsetY+100;      window.showModalDialog(URL,self,\"edge:raised;scroll:0;status:0;help:0;resizable:1;dialogWidth:300px;dialogHeight:250px;dialogTop:\"+loc_y+\"p";
echo "x;dialogLeft:\"+loc_x+\"px\");      //window.open(URL,\"\",\"menubar=0,toolbar=0,status=0,scrollbars=1,resizable=1,width=400px,height=300px,Top=\"+loc_y+\"px,Left=\"+loc_x+\"px\");    }        function query_date(field)    {      init_value=field;      URL=\"../../Framework/sms_index/calendar_begin.php?datetime=\"+init_value;      loc_x=document.body.scrollLeft+event.clientX-event.offsetX+350;      loc_y=document.body.scrol";
echo "lTop+event.clientY-event.offsetY+100;      window.showModalDialog(URL,self,\"edge:raised;scroll:0;status:0;help:0;resizable:1;dialogWidth:280px;dialogHeight:205px;dialogTop:\"+loc_y+\"px;dialogLeft:\"+loc_x+\"px\");      //window.open(URL,\"\",\"menubar=0,toolbar=0,status=0,scrollbars=1,resizable=1,width=400px,height=300px,Top=\"+loc_y+\"px,Left=\"+loc_x+\"px\");    }    var fld_name_display=\"\";    function set_explain(f";
echo "ield,BURSAR_ATTR)    {      document.all(field).style.display=\"\";      if(fld_name_display!=\"\")      document.all(fld_name_display).style.display=\"none\";      fld_name_display=field;      //alert(BURSAR_ATTR);      if (BURSAR_ATTR.length>0)             {             var cust=BURSAR_ATTR.substring(0,1);//单位             custfield=field+\"1\";             if (cust==1)             {             document.all(custfield).style.di";
echo "splay=\"\";             }             else             {             document.all(custfield).style.display=\"none\";             }                 var dept=BURSAR_ATTR.substring(1,2);//部门             deptfield=field+\"2\";             if (dept==1)             {             document.all(deptfield).style.display=\"\";             }             else             {             document.all(deptfield).style.display=\"none\";             }        ";
echo "         var empl=BURSAR_ATTR.substring(2,3);//人员             emplfield=field+\"3\";             if (empl==1)             {             document.all(emplfield).style.display=\"\";             }             else             {             document.all(emplfield).style.display=\"none\";             }                 var class1=BURSAR_ATTR.substring(3,4);//统计             class1field=field+\"4\";             if (class1==1)           ";
echo "  {             document.all(class1field).style.display=\"\";             }             else             {             document.all(class1field).style.display=\"none\";             }             var class2=BURSAR_ATTR.substring(4,5);//项目             class2field=field+\"5\";             if (class2==1)             {             document.all(class2field).style.display=\"\";             }             else             {             docum";
echo "ent.all(class2field).style.display=\"none\";             }             }        }    function query_voucher(field,ModuleId,row,typeid)    {      init_value=document.all(field).value;      URL=\"/voucher/index.jsp?FIELDNAME=\"+field+\"&voucher=\"+ModuleId+\"&INIT_VALUE=\"+init_value+\"&row=\"+row+\"&typeid=\"+typeid;      loc_x=document.body.scrollLeft+event.clientX-event.offsetX+350;      loc_y=document.body.scrollTop+event.clie";
echo "ntY-event.offsetY+100;      window.showModalDialog(URL,self,\"edge:raised;scroll:0;status:0;help:0;resizable:1;dialogWidth:400px;dialogHeight:250px;dialogTop:\"+loc_y+\"px;dialogLeft:\"+loc_x+\"px\");      //window.open(URL,\"\",\"menubar=0,toolbar=0,status=0,scrollbars=1,resizable=1,width=400px,height=300px,Top=\"+loc_y+\"px,Left=\"+loc_x+\"px\");    }    function balance_query_code(field,grp_no)    {      grp_no=document";
echo ".all(grp_no).value;      init_value=document.all(field).value;      code=document.all(field+\"_CODE\").value;      table=document.all(field+\"_TABLE\").value;          URL=\"/balancequery/index.jsp?CODE=\"+code+\"&TABLE=\"+table+\"&FIELD=\"+field+\"&INIT_VALUE=\"+init_value+\"&GRP_NO=\"+grp_no;      loc_x=document.body.scrollLeft+event.clientX-event.offsetX+350;      loc_y=document.body.scrollTop+event.clientY-event.offsetY+";
echo "100;      window.showModalDialog(URL,self,\"edge:raised;scroll:0;status:0;help:0;resizable:1;dialogWidth:300px;dialogHeight:250px;dialogTop:\"+loc_y+\"px;dialogLeft:\"+loc_x+\"px\");      //window.open(URL,\"\",\"menubar=0,toolbar=0,status=0,scrollbars=1,resizable=1,width=400px,height=300px,Top=\"+loc_y+\"px,Left=\"+loc_x+\"px\");    }        //verify for netscape/mozilla    var isNS4 = (navigator.appName==\"Netscape\")?1:0;";
echo "        function check_input_num(num_type)    {      if(num_type==\"NUMBER\")      {         if(!isNS4)         {         \t if((event.keyCode < 48 || event.keyCode > 57)&&event.keyCode != 46)         \t    event.returnValue = false;         }         else         {         \t if((event.which < 48 || event.which > 57)&&event.keyCode != 46)         \t    return false;         }      }      else if(num_type==\"MONEY\")      {         if(!isNS4)    ";
echo "     {         \t if((event.keyCode < 45 || event.keyCode > 57)&&event.keyCode != 47)         \t    event.returnValue = false;         }         else         {         \t if((event.which < 45 || event.which > 57)&&event.which != 47)         \t    return false;         }      }    }        function  ForDight(Dight,How)    {               Dight  =  Math.round  (Dight*Math.pow(10,How))/Math.pow(10,How);               return  Dight;    }\r";
echo "\n    function check_value(field)    {       var obj=document.all(field);       if(obj.value==\"\")          return;                 addMoneyStr(field);           }        function  init_value(field)    {       var obj=document.all(field);          if (obj.value==\"\")          return;           re=/,/g;       obj.value=obj.value.replace(re,\"\");    }    function uploadFromFile() {      openurl=\"/fileupload/index.jsp\";      loc_x=300;      loc_y=20";
echo "0;      window.open(openurl,\"fileupload\",\"menubar=0,toolbar=0,status=0,scrollbars=1,resizable=1,width=400px,height=300px,Top=\"+loc_y+\"px,Left=\"+loc_x+\"px\");    }        function detailclick(idRowid,ModuleId)    {          URL=\"/detail.jsp?rowid=\"+idRowid+\"&ModuleId=\"+ModuleId;       loc_x=254;       loc_y=162;      window.showModalDialog(URL,self,\"edge:raised;scroll:1;status:1;help:1;resizable:1;dialogWidth:870px;d";
echo "ialogHeight:300px;dialogTop:\"+loc_y+\"px;dialogLeft:\"+loc_x+\"px\");      //window.open(URL,\"qq\",\"menubar=0,toolbar=0,status=0,scrollbars=1,resizable=1,width=650px,height=250px,Top=\"+loc_y+\"px,Left=\"+loc_x+\"px\");    }    function datadetailclick(idRowid,ModuleId)    {       \t var stockName=document.Qform1(\"stockName\").value;    \t var fromdata=document.Qform1(\"fromdata\").value;    \t var enddata=document.Qform1(\"end";
echo "data\").value;    \t        URL=\"/datadetail.jsp?rowid=\"+idRowid+\"&ModuleId=\"+ModuleId+\"&stockName=\"+stockName+\"&fromdata=\"+fromdata+\"&enddata=\"+enddata;       loc_x=254;       loc_y=162;      window.open(URL,\"qq\",\"menubar=0,toolbar=0,status=0,scrollbars=1,resizable=1,width=650px,height=250px,Top=\"+loc_y+\"px,Left=\"+loc_x+\"px\");    }        function datadetail(State)    {          var idRowid=document.all(\"ID_STR\").valu";
echo "e;\t       if(idRowid==\"\")       {          alert(\"请至少选中一项查看明细！\");          return false;       }       idRowid=idRowid.substring(0,idRowid.length-1);              var ModuleId=document.all(\"ModuleId\").value;       var stockName=document.Qform1(\"stockName\").value;    \t var fromdata=document.Qform1(\"fromdata\").value;    \t var enddata=document.Qform1(\"enddata\").value;       URL=\"/datadetail.jsp?rowid=\"+idRowid+\"";
echo "&ModuleId=\"+ModuleId+\"&stockName=\"+stockName+\"&fromdata=\"+fromdata+\"&enddata=\"+enddata+\"&State=\"+State;       loc_x=100;       loc_y=100;      window.open(URL,\"qq\",\"menubar=0,toolbar=0,status=0,scrollbars=1,resizable=1,width=900px,height=400px,Top=\"+loc_y+\"px,Left=\"+loc_x+\"px\");    }    function datadetailchart(chartState)    {          var idRowid=document.all(\"ID_STR\").value;\t       if (chartState==\"1\"){         ";
echo " if(idRowid==\"\")          {          alert(\"请至少选中一项！\");          return false;          }       }       idRowid=idRowid.substring(0,idRowid.length-1);       var ModuleId=document.all(\"ModuleId\").value;    \t var fromdata=document.Qform1(\"fromdata\").value;    \t var enddata=document.Qform1(\"enddata\").value;    \t var groupByStr=document.Qform1(\"groupByStr\").value;    \t var flowState=document.Qform1(\"flowState\").val";
echo "ue;    \t var dataState=document.Qform1(\"dataState\").value;    \t        URL=\"/setSql6.jsp?rowid=\"+idRowid+\"&ModuleId=\"+ModuleId+\"&groupByStr=\"+groupByStr+\"&fromdata=\"+fromdata+\"&enddata=\"+enddata+\"&flowState=\"+flowState+\"&dataState=\"+dataState+\"&chartState=\"+chartState;//       loc_x=254;       loc_y=162;       //alert(URL);       window.showModalDialog(URL,self,\"edge:raised;scroll:0;status:0;help:0;resizable:1;";
echo "dialogWidth:400px;dialogHeight:350px;dialogTop:\"+loc_y+\"px;dialogLeft:\"+loc_x+\"px\");       //window.open(URL,\"qq\",\"menubar=0,toolbar=0,status=0,scrollbars=1,resizable=1,width=650px,height=250px,Top=\"+loc_y+\"px,Left=\"+loc_x+\"px\");    }    function dataPrint()    {          var idRowid=document.all(\"ID_STR\").value;\t              if(idRowid==\"\")          {          alert(\"请至少选中一项！\");          return false;        ";
echo "  }           idRowid=idRowid.substring(0,idRowid.length-1);       var ModuleId=document.all(\"ModuleId\").value;    \t        URL=\"/setSqlPrint.jsp?rowid=\"+idRowid+\"&ModuleId=\"+ModuleId;//       loc_x=254;       loc_y=162;       //alert(URL);       //window.showModalDialog(URL,self,\"edge:raised;scroll:0;status:0;help:0;resizable:1;dialogWidth:400px;dialogHeight:350px;dialogTop:\"+loc_y+\"px;dialogLeft:\"+loc_x+\"px\");     ";
echo "  window.open(URL,\"qq\",\"menubar=0,toolbar=0,status=0,scrollbars=1,resizable=1,width=650px,height=250px,Top=\"+loc_y+\"px,Left=\"+loc_x+\"px\");    }    function datachart()    {          var idRowid=document.all(\"ID_STR\").value;\t       if(idRowid==\"\")       {          alert(\"请至少选中一项查看明细！\");          return false;       }       idRowid=idRowid.substring(0,idRowid.length-1);              var ModuleId=document.all(\"M";
echo "oduleId\").value;       var stockName=document.Qform1(\"stockName\").value;    \t var fromdata=document.Qform1(\"fromdata\").value;    \t var enddata=document.Qform1(\"enddata\").value;       URL=\"/datachart.jsp?rowid=\"+idRowid+\"&ModuleId=\"+ModuleId+\"&stockName=\"+stockName+\"&fromdata=\"+fromdata+\"&enddata=\"+enddata;       loc_x=254;       loc_y=162;      window.showModalDialog(URL,self,\"edge:raised;scroll:0;status:0;help";
echo ":0;resizable:1;dialogWidth:770px;dialogHeight:500px;dialogTop:\"+loc_y+\"px;dialogLeft:\"+loc_x+\"px\");      //window.open(URL,\"qq\",\"menubar=0,toolbar=0,status=0,scrollbars=1,resizable=1,width=750px,height=450px,Top=\"+loc_y+\"px,Left=\"+loc_x+\"px\");    }    function detail()    {          var idRowid=document.all(\"ID_STR\").value;\t       if(idRowid==\"\")       {          alert(\"请至少选中一项查看明细！\");          return f";
echo "alse;       }       idRowid=idRowid.substring(0,idRowid.length-1);              var ModuleId=document.all(\"ModuleId\").value;       URL=\"/detail.jsp?rowid=\"+idRowid+\"&ModuleId=\"+ModuleId;       loc_x=154;       loc_y=162;      window.showModalDialog(URL,self,\"edge:raised;scroll:1;status:1;help:1;resizable:1;dialogWidth:870px;dialogHeight:300px;dialogTop:\"+loc_y+\"px;dialogLeft:\"+loc_x+\"px\");      //window.open(URL,\"q";
echo "q\",\"menubar=0,toolbar=0,status=0,scrollbars=1,resizable=1,width=850px,height=250px,Top=\"+loc_y+\"px,Left=\"+loc_x+\"px\");    }    function detailsec(ModuleId)    {          var idRowid=document.all(\"ID_STR\").value;\t       if(idRowid==\"\")       {          alert(\"请至少选中一项查看明细！\");          return false;       }       idRowid=idRowid.substring(0,idRowid.length-1);       URL=\"/detailsec.jsp?rowid=\"+idRowid+\"&ModuleI";
echo "d=\"+ModuleId;       loc_x=10;       loc_y=10;       //alert(URL);      window.open(URL,\"qq\",\"menubar=0,toolbar=0,status=0,scrollbars=1,resizable=1,width=900px,height=550px,Top=\"+loc_y+\"px,Left=\"+loc_x+\"px\");    }    function flow()    {          var idRowid=document.all(\"ID_STR\").value;\t       if(idRowid==\"\")       {          alert(\"请至少选中一项查看！\");          return false;       }       idRowid=idRowid.substring(0,idRo";
echo "wid.length-1);              var ModuleId=document.all(\"ModuleId\").value;       URL=\"/flowdetail.jsp?rowid=\"+idRowid+\"&ModuleId=\"+ModuleId;       loc_x=254;       loc_y=162;      window.open(URL,\"qq\",\"menubar=0,toolbar=0,status=0,scrollbars=1,resizable=1,width=650px,height=250px,Top=\"+loc_y+\"px,Left=\"+loc_x+\"px\");    }    function backStock()    {          var idRowid=document.all(\"ID_STR\").value;\t       if(idRowid==\"\")";
echo "       {          alert(\"请至少选中一项进行退货！\");          return false;       }       idRowid=idRowid.substring(0,idRowid.length-1);              var ModuleId=document.all(\"ModuleId\").value;       URL=\"/back.jsp?rowid=\"+idRowid+\"&ModuleId=\"+ModuleId;       loc_x=254;       loc_y=162;      window.open(URL,\"qq\",\"menubar=0,toolbar=0,status=0,scrollbars=1,resizable=1,width=750px,height=250px,Top=\"+loc_y+\"px,Left=\"+loc_";
echo "x+\"px\");    }    function printDetail(openrul)    {       var idStr=document.all(\"ID_STR\").value;       var idRowid=idStr.substring(0,18)+\",\";       if(idStr==\"\")       {          alert(\"请选中一项进行打印！\");          return false;       }       if(idStr.indexOf(\",\") < idStr.length-1)       {          alert(\"只能选中一项进行打印！\");          return false;       }       URL=openrul+\"?rowid=\"+idStr;       loc_x=300;       loc_y=200;";
echo "       //window.showModalDialog(URL,self,\"edge:raised;scroll:1;status:1;help:1;resizable:1;dialogWidth:770px;dialogHeight:500px;dialogTop:\"+loc_y+\"px;dialogLeft:\"+loc_x+\"px\");       window.open(URL,\"\",\"menubar=1,toolbar=1,status=1,scrollbars=1,resizable=1,width=700px,height=450px,Top=\"+loc_y+\"px,Left=\"+loc_x+\"px\");    }    function secorderInput(thisBut){    if (event.keyCode == 13)    {    secorderquery();\t    }";
echo "    thisBut.onfocus();    }    function queryInput(thisBut){    if (event.keyCode == 13)    {    query();\t    }    thisBut.onfocus();    }         function addMoneyStr(moneyField){     \t     \t  if (document.form1(moneyField).value.indexOf(\",\")>=0){     \t  \treturn;     \t  \t}     \t       if(document.form1(moneyField).value==\"\")          return;        if(document.form1(moneyField).value.substring(0,1)==\"-\")       {       \t   op_Money=\"-\";    ";
echo "   \t   document.form1(moneyField).value=document.form1(moneyField).value.substring(1,document.form1(moneyField).value.length);       }       else           op_Money=\"\";                   val_Money=parseFloat(document.form1(moneyField).value);           document.form1(moneyField).value=ForDight(val_Money,amtdot);        var value_array_Money=document.form1(moneyField).value.split(\".\");           start_Money=0;       l";
echo "en_Money=0;       val_int_Money=\"\";           while(1)       {       \t  if((value_array_Money[0].length-start_Money)%3==0)       \t     len_Money=3;       \t  else       \t  \t len_Money=value_array_Money[0].length%3;              if(val_int_Money==\"\")             val_int_Money=value_array_Money[0].substring(start_Money,start_Money+len_Money);          else             val_int_Money=val_int_Money+\",\"+value_array_Money[0].subst";
echo "ring(start_Money,start_Money+len_Money);       \t  start_Money=len_Money+start_Money;           \t  if(start_Money>=value_array_Money[0].length)       \t     break;       }       if(val_int_Money!=\"\")          value_array_Money[0]=val_int_Money;           if(value_array_Money.length==1)       \t  value_array_Money[1]=\"00\";       else if(value_array_Money.length==amtdot)       {       \t  if(value_array_Money[1].length==0)       \t";
echo "    value_array_Money[1]=\"00\";       \t  else if(value_array_Money[1].length==1)       \t    value_array_Money[1]=value_array_Money[1]+\"0\";       \t  else if(value_array_Money[1].length>=amtdot)       \t    value_array_Money[1]=value_array_Money[1].substr(0,amtdot);       }       document.form1(moneyField).value=op_Money+value_array_Money[0]+\".\"+value_array_Money[1];     \t}     \tfunction detailFlow(dataState)    {       ";
echo "   var idRowid=document.all(\"ID_STR\").value;\t       if(idRowid==\"\")       {          alert(\"请至少选中一项查看明细！\");          return false;       }       idRowid=idRowid.substring(0,idRowid.length-1);              var ModuleId=document.all(\"ModuleId\").value;       URL=\"/detailflow.jsp?rowid=\"+idRowid+\"&ModuleId=\"+ModuleId+\"&dataState=\"+dataState;       loc_x=100;       loc_y=100;      window.showModalDialog(URL,self,\"";
echo "edge:raised;scroll:1;status:1;help:1;resizable:1;dialogWidth:970px;dialogHeight:500px;dialogTop:\"+loc_y+\"px;dialogLeft:\"+loc_x+\"px\");      //window.open(URL,\"qq\",\"menubar=0,toolbar=0,status=0,scrollbars=1,resizable=1,width=850px,height=250px,Top=\"+loc_y+\"px,Left=\"+loc_x+\"px\");    }        function query_stock(field)    {      init_value=document.all(field).value;      code=document.all(field+\"_CODE\").value;      ";
echo "table=document.all(field+\"_TABLE\").value;      ModuleId=document.all(\"ModuleId\").value;      URL=\"/querystock/index.jsp?CODE=\"+code+\"&TABLE=\"+table+\"&FIELD=\"+field+\"&INIT_VALUE=\"+init_value+\"&ModuleId=\"+ModuleId;      loc_x=document.body.scrollLeft+event.clientX-event.offsetX+350;      loc_y=document.body.scrollTop+event.clientY-event.offsetY+100;      window.showModalDialog(URL,self,\"edge:raised;scroll:0;s";
echo "tatus:0;help:0;resizable:1;dialogWidth:750px;dialogHeight:450px;dialogTop:\"+loc_y+\"px;dialogLeft:\"+loc_x+\"px\");      //window.open(URL,\"\",\"menubar=0,toolbar=0,status=0,scrollbars=1,resizable=1,width=400px,height=300px,Top=\"+loc_y+\"px,Left=\"+loc_x+\"px\");    }        \tfunction editSate(StateId)    {       var idStr=document.all(\"ID_STR\").value;       var ModuleId=document.all(\"ModuleId\").value;                      if(";
echo "idStr==\"\")       {          alert(\"请选中一项编辑！\");          return false;       }       URL=\"/changestate/index.jsp?rowid=\"+idStr+\"&ModuleId=\"+ModuleId+\"&StateId=\"+StateId;          //   engserv\\module\\code\\changestate       //URL=openrul+\"?rowid=\"+idStr+\"&ModuleId=\"+ModuleId;       loc_x=300;       loc_y=200;      // alert(URL);       //window.showModalDialog(URL,self,\"edge:raised;scroll:0;status:0;help:0;resizabl";
echo "e:1;dialogWidth:450px;dialogHeight:250px;dialogTop:\"+loc_y+\"px;dialogLeft:\"+loc_x+\"px\");          window.open(URL,\"\",\"menubar=0,toolbar=0,status=0,scrollbars=1,resizable=1,width=400px,height=150px,Top=\"+loc_y+\"px,Left=\"+loc_x+\"px\");    }    function query_supply(field)    {      init_value=document.all(field).value;      code=document.all(field+\"_CODE\").value;      table=document.all(field+\"_TABLE\").value;      Mod";
echo "uleId=document.all(\"ModuleId\").value;      URL=\"../../Framework/frame_depart_notify.php?title=选择记录&tablename=supply&fieldid=supplyid&fieldname=supplyname&field=\"+field+\"&field2=\"+field+\"_NAME&INIT_VALUE=\"+init_value+\"\";      loc_x=document.body.scrollLeft+event.clientX-event.offsetX+350;      loc_y=document.body.scrollTop+event.clientY-event.offsetY+100;      window.showModalDialog(URL,self,\"edge:rais";
echo "ed;scroll:0;status:0;help:0;resizable:1;dialogWidth:750px;dialogHeight:450px;dialogTop:\"+loc_y+\"px;dialogLeft:\"+loc_x+\"px\");      //window.open(URL,\"\",\"menubar=0,toolbar=0,status=0,scrollbars=1,resizable=1,width=400px,height=300px,Top=\"+loc_y+\"px,Left=\"+loc_x+\"px\");    }            var imgpath = \"/images/images/\";            function toggleSetting(id) {    \tvar div = document.all[id];    \tvar img = document.all[id+\"_";
echo "tgimg\"];    \t//var stockInitButton = document.all[\"stockInitButton\"];    \tif (div.style.display == \"none\") {    \t\tdiv.style.display = \"block\";    \t\timg.src = imgpath + \"minus.gif\";    \t\t//stockInitButton.style.display = \"block\";    \t}    \telse {    \t\tdiv.style.display = \"none\";    \t\t//stockInitButton.style.display = \"none\";    \t\timg.src = imgpath + \"plus.gif\";    \t}    }        function check_value2(field)    {      //alert(fiel";
echo "d);      init_value=document.all(field).value;      ModuleId=document.all(\"ModuleId\").value;      Add_table=document.all(\"Add_table\").value;      if (init_value==null||init_value==\"\"){      alert(\"请先输入要验证的内容\");      return false;      \t}      URL=\"/checkvalue/index.jsp?ModuleId=\"+ModuleId+\"&Add_table=\"+Add_table+\"&INIT_VALUE=\"+init_value+\"&field=\"+field;      loc_x=document.body.scrollLeft+event.clientX-e";
echo "vent.offsetX+350;      loc_y=document.body.scrollTop+event.clientY-event.offsetY+100;      window.showModalDialog(URL,self,\"edge:raised;scroll:0;status:0;help:0;resizable:1;dialogWidth:450px;dialogHeight:250px;dialogTop:\"+loc_y+\"px;dialogLeft:\"+loc_x+\"px\");      //window.open(URL,\"\",\"menubar=0,toolbar=0,status=0,scrollbars=1,resizable=1,width=400px,height=300px,Top=\"+loc_y+\"px,Left=\"+loc_x+\"px\");    }    </s";
echo "cript>            ";
echo "<s";
echo "cript language=javascript>        var amtdot='0';    if  (amtdot==\"\"||amtdot==null){    \tamtdot=2;    \t}    var numdot='0';    if  (numdot==\"\"||numdot==null){    \tnumdot=2;    \t}    var outType='1';    var numdotValue=\"\";    var amtdotValue=\"\";    //alert(\"numdot=\"+numdot);    for (i=0;i<numdot;i++){    \tnumdotValue=numdotValue+\"0\";    \t}    for (i=0;i<amtdot;i++){    \tamtdotValue=amtdotValue+\"0\";    \t}\t    //alert(\"numdotValue=\"+numdotVa";
echo "lue);     var tmpStr=\"\";     var temInt=1;     var standtmpStr=\"\";     var dataTemStr=\"\";     var fieldNum2=\"\";      function refreshClienArea() {        var tempStr=hiddenDataId.innerHTML.replace(\"style=\\\"DISPLAY:\",\"\");        //alert(tempStr);        var repStr=\"value=\"+temInt+\" name=dataNo> <B>\"+temInt+\"</B>\";        tempStr=tempStr.replace(\"value=1 name=dataNo> <B>1</B>\",repStr);        tempStr=tempStr.replace(\"none\\\"\"";
echo ",\"\");        var repStr2=\"_wxd_\"+temInt;//        tempStr=tempStr.replace(\"_wxd_1\",repStr2);        var repStr3=\"_wxdid_\"+temInt;//        tempStr=tempStr.replace(\"_wxdid_1\",repStr3);        var repStr5=\"_wxdnum_\"+temInt;//        tempStr=tempStr.replace(\"_wxdnum_1\",repStr5);        var repStr6=\"_wxdrate_\"+temInt;//        tempStr=tempStr.replace(\"_wxdrate_1\",repStr6);        var repStr4=\"dataClick('\"+temInt+\"')\";/";
echo "/        tempStr=tempStr.replace(\"dataClick('1')\",repStr4);        var sStr=/dxw/g;        tempStr=tempStr.replace(sStr,temInt);        //alert(tempStr);        if (tmpStr==\"\")        {        standtmpStr=tempStr;         tmpStr = tempStr;   \t        }else{        tmpStr += tempStr;        }            //alert(tmpStr);        clientArea.innerHTML = tmpStr;         }      function deleteClienArea() {      \tvar dataCount=document.";
echo "form1(\"dataCount\").value;      \t//alert(\"dataCount:\"+dataCount);            if (tmpStr==\"\")        {         temInt=1;         alert(\"无法删除！\");   \t         return;        }else{        var cuntMon=0;        for (var i=1;i<=temInt;i++)        {    \t        \tif (document.form1(\"money_\"+i).value!=\"\"&&document.form1(\"money_\"+i).value!=null){        \tcuntMon=cuntMon+parseFloat(document.form1(\"money_\"+i).value);            }\r";
echo "\n    }        if (cuntMon!=0&&cuntMon!=null){        document.form1(\"amt\").value=cuntMon;        }        tmpStr = tmpStr.substring(0,tmpStr.length-standtmpStr.length);        document.form1(\"dataCount\").value=parseFloat(dataCount)-1;        }        clientArea.innerHTML = tmpStr;         }      function deleteUpdateClienArea() {         \ttemInt--;       \t        if (tmpStr==\"\")        {        \tif (dataTemStr!=\"\")            ";
echo " \t{    \t                 dataId.innerHTML = dataTemStr.substring(0,dataTemStr.lastIndexOf(\"<TABLE\"));             var intDel=dataId.innerHTML.substring(dataId.innerHTML.lastIndexOf(\"money_\")+6,dataId.innerHTML.lastIndexOf(\"money_\")+7)            var cuntMon=0;        for (var i=1;i<=parseInt(intDel);i++)        {            \tif (document.form1(\"money_\"+i).value!=\"\"&&document.form1(\"money_\"+i).value!=null){        \tcu";
echo "ntMon=cuntMon+parseFloat(document.form1(\"money_\"+i).value);            }        }        if (cuntMon!=0&&cuntMon!=null){        document.form1(\"amt\").value=cuntMon;        }            }        }else{                        tmpStr = tmpStr.substring(0,tmpStr.length-standtmpStr.length);        clientArea.innerHTML = tmpStr;        var intDel=clientArea.innerHTML.substring(clientArea.innerHTML.lastIndexOf(\"money_\")+6,clien";
echo "tArea.innerHTML.lastIndexOf(\"money_\")+7)            var cuntMon=0;        for (var i=1;i<=parseInt(intDel);i++)        {            \tif (document.form1(\"money_\"+i).value!=\"\"&&document.form1(\"money_\"+i).value!=null){        \tcuntMon=cuntMon+parseFloat(document.form1(\"money_\"+i).value);            }        }        if (cuntMon!=0&&cuntMon!=null){        document.form1(\"amt\").value=cuntMon;        }        }             }      f";
echo "unction insertRow() {      if (event.keyCode == 10){          tmpStr = clientArea.innerHTML;                temInt++;        refreshClienArea();        }      }      function dataQuery(fieldname,moduleId,countStr) {      if (event.keyCode == 10){          var dataStr=dataId.innerHTML;        var hasInt1=dataStr.lastIndexOf(\"name=dataNo\")-2;        var hasInt2=dataStr.lastIndexOf(\"name=dataNo\")-1;        var hasInt=dataStr.";
echo "substring(dataStr.lastIndexOf(\"name=dataNo\")-2,dataStr.lastIndexOf(\"name=dataNo\")-1)        //alert(hasInt);        if (temInt==1){           if (hasInt>temInt){           temInt=hasInt;           }        }        temInt++;        tmpStr = clientArea.innerHTML;        refreshClienArea();      }else if (event.keyCode == 13||event.keyCode == 0){      var cliNo=document.form1(\"hidDataNo\").value;      var supplyId=\"\";      va";
echo "r stockId=\"\";      var typeId=\"0\";      if (document.getElementById(\"supplyid\")!=null){      supplyId=document.form1(\"supplyid\").value;      if (supplyId==null||supplyId==\"\"){      \talert(\"请先确定单位\");      \treturn;      \t}      }      if (document.getElementById(\"intype\")!=null){      typeId=document.all(\"intype\").value;        }      if (document.getElementById(\"outtype\")!=null){      typeId=document.all(\"outtype\").va";
echo "lue;        }      if (document.getElementById(\"stockId\")!=null){      stockId=document.all(\"stockId\").value;        }      //var stockId=document.all(\"stockId\").value;              var fieldValue=document.form1(\"id_\"+fieldname+\"_\"+countStr+\"_wxd_\"+cliNo).value;      var codeValue=document.form1(\"id_\"+fieldname+\"_id\"+\"_\"+countStr+\"_wxdid_\"+cliNo).value;              URL=\"/dataquery/index.jsp?moduleId=\"+moduleId+\"&fie";
echo "ldname=\"+fieldname+\"&fieldValue=\"+fieldValue+\"&codeValue=\"+codeValue+\"&countStr=\"+countStr+\"&cliNo=\"+cliNo+\"&supplyId=\"+supplyId+\"&stockId=\"+stockId+\"&typeId=\"+typeId;       loc_x=0;       loc_y=0;       //alert(URL);      window.showModalDialog(URL,self,\"edge:raised;scroll:0;status:0;help:0;resizable:1;dialogWidth:1000px;dialogHeight:500px;dialogTop:\"+loc_y+\"px;dialogLeft:\"+loc_x+\"px\");      //window.open(";
echo "URL,\"qqq\",\"menubar=0,toolbar=0,status=0,scrollbars=1,resizable=1,width=900px,height=450px,Top=\"+loc_y+\"px,Left=\"+loc_x+\"px\");          }      }        function orderQuery(fieldname,moduleId,countStr) {\t      if (event.keyCode == 10){          var dataStr=dataId.innerHTML;        var hasInt1=dataStr.lastIndexOf(\"name=dataNo\")-2;        var hasInt2=dataStr.lastIndexOf(\"name=dataNo\")-1;        var hasInt=dataStr.subst";
echo "ring(dataStr.lastIndexOf(\"name=dataNo\")-2,dataStr.lastIndexOf(\"name=dataNo\")-1)        //alert(hasInt);        if (temInt==1){           if (hasInt>temInt){           temInt=hasInt;           }        }        temInt++;        tmpStr = clientArea.innerHTML;        refreshClienArea();      }else if (event.keyCode == 13){      var cliNo=document.form1(\"hidDataNo\").value;      var fieldValue=document.form1(\"id_\"+fieldname+\"";
echo "_\"+countStr+\"_wxd_\"+cliNo).value;      var codeValue=document.form1(\"id_\"+fieldname+\"_id\"+\"_\"+countStr+\"_wxdid_\"+cliNo).value;      var supplyId=document.form1(\"supplyid\").value;      var tableDate=document.form1(\"tabledate\").value;      URL=\"/orderquery/index.jsp?moduleId=\"+moduleId+\"&fieldname=\"+fieldname+\"&fieldValue=\"+fieldValue+\"&codeValue=\"+codeValue+\"&countStr=\"+countStr+\"&cliNo=\"+cliNo+\"&supplyId=";
echo "\"+supplyId+\"&tableDate=\"+tableDate;       loc_x=354;       loc_y=262;      window.showModalDialog(URL,self,\"edge:raised;scroll:0;status:0;help:0;resizable:1;dialogWidth:350px;dialogHeight:250px;dialogTop:\"+loc_y+\"px;dialogLeft:\"+loc_x+\"px\");      }          }        function amtQuery(fieldname,moduleId,countStr) {      if (event.keyCode == 10){          var dataStr=dataId.innerHTML;        var hasInt1=dataStr.lastI";
echo "ndexOf(\"name=dataNo\")-2;        var hasInt2=dataStr.lastIndexOf(\"name=dataNo\")-1;        var hasInt=dataStr.substring(dataStr.lastIndexOf(\"name=dataNo\")-2,dataStr.lastIndexOf(\"name=dataNo\")-1)        if (temInt==1){           if (hasInt>temInt){           temInt=hasInt;           }        }        temInt++;        tmpStr = clientArea.innerHTML;        refreshClienArea();      }else if (event.keyCode == 13||event.keyCod";
echo "e == 0){      var cliNo=document.form1(\"hidDataNo\").value;      var supplyId=document.form1(\"supplyid\").value;      var fieldValue=document.form1(\"id_\"+fieldname+\"_\"+countStr+\"_wxd_\"+cliNo).value;      var codeValue=document.form1(\"id_\"+fieldname+\"_id\"+\"_\"+countStr+\"_wxdid_\"+cliNo).value;      URL=\"/amtquery/index.jsp?moduleId=\"+moduleId+\"&fieldname=\"+fieldname+\"&fieldValue=\"+fieldValue+\"&codeValue=\"+codeVa";
echo "lue+\"&countStr=\"+countStr+\"&cliNo=\"+cliNo+\"&supplyId=\"+supplyId;       loc_x=354;       loc_y=262;      window.showModalDialog(URL,self,\"edge:raised;scroll:0;status:0;help:0;resizable:1;dialogWidth:700px;dialogHeight:300px;dialogTop:\"+loc_y+\"px;dialogLeft:\"+loc_x+\"px\");      }          }      function clickInsertRow() {        var dataStr=dataId.innerHTML;        var hasInt1=dataStr.lastIndexOf(\"name=dataNo\")-2;\r";
echo "\n    var hasInt2=dataStr.lastIndexOf(\"name=dataNo\")-1;        var hasInt=dataStr.substring(dataStr.lastIndexOf(\"name=dataNo\")-2,dataStr.lastIndexOf(\"name=dataNo\")-1)        //alert(\"hasInt:\"+hasInt);        //alert(\"dataStr:\"+dataStr);        if (temInt==1){           if (hasInt>temInt){           temInt=hasInt;           }        }        temInt++;                var dataCount=document.form1(\"dataCount\").value;        /";
echo "/alert(\"33dataCount:\"+dataCount);        //alert(\"dataCount:\"+dataCount);        var addDataCount=parseFloat(dataCount)+1;        temInt=addDataCount;        dataCount=addDataCount.toString();        //document.form1(\"dataCount\").value=addDataCount.toString();        //dataCount=document.form1(\"dataCount\").value;        //alert(\"33dataCount:\"+dataCount);        document.form1(\"dataCount\").value=dataCount;        tm";
echo "pStr = clientArea.innerHTML;            //alert(\"tmpStr:\"+tmpStr);        refreshClienArea();      }      function clickDeleteRow() {        tmpStr = clientArea.innerHTML;        temInt--;        deleteClienArea();      }    function secaddnew()    {       if(value_empty(\"FLD_MUST_STR\",\"FLD_NAME_STR\"))          return (false);       form1.flag.value=\"secaddnew\";       form1.submit();    }    function secupdate()    {       if(value_";
echo "empty(\"FLD_MUST_STR\",\"FLD_NAME_STR\"))          return (false);       form1.flag.value=\"secupdate\";       form1.submit();    }    function secamtaddnew()    {       var i=0;          var tableName=document.all.form1.Add_table.value       var idValue=\"id_stockinid_id_1_wxdid_\";       if (tableName==\"getmain\")       {       idValue=\"id_stockoutid_id_1_wxdid_\";\t       }       var idValue2=\"thispaymoney_\";              var dataArea=d";
echo "ataId.innerHTML;       var dataClient=clientArea.innerHTML;       var dataLast=\"\";       if (tableName==\"getmain\")       {       dataLast=dataClient.lastIndexOf(\"id_stockoutid_id_1_wxdid\");       }else{       dataLast=dataClient.lastIndexOf(\"id_stockinid_id_1_wxdid\");       }       var dataLast2=dataClient.indexOf(\"thispaymoney_\");           var int1=-1;       if (tableName==\"getmain\")       {       int1=dataClient.substring";
echo "(dataLast+25,dataLast+26);       }else{       int1=dataClient.substring(dataLast+24,dataLast+25);       }       var int2=dataClient.substring(dataLast2+13,dataLast2+14);       if(dataLast==-1){       \tint1=1;       \t}       var value1;       var value2;       var value3=0;       for (i=1;i<=int1;i++){  \t       if (tableName==\"getmain\")       {       idValue=idValue.substring(0,25)+i;         }else{       idValue=idValue.substring";
echo "(0,24)+i;         }       idValue2=idValue2.substring(0,13)+i;       if (i==1){       if (tableName==\"getmain\")       {       value1=document.all.form1.id_stockoutid_id_1_wxdid_1.value;       }else{       value1=document.all.form1.id_stockinid_id_1_wxdid_1.value;       }       }else{       value1=document.all(idValue).value;       }       if (i==1){       value2=document.all.form1.thispaymoney_1.value;       }else{       value2=";
echo "document.all(idValue2).value;       }           if (value1==null||value1==\"\"){       \talert(\"请在第\"+i+\"行第1列通过双击选择商品信息\");       \treturn;       \t}          if (value2==null||value2==\"\"){       \talert(\"请在第\"+i+\"行第4列输入商品数量\");       \treturn;       \t}       \tvar sStr=/,/g;             value2=value2.replace(sStr,\"\");         value3=value3+parseFloat(value2);          }       if (document.getElementById(\"fac";
echo "tgetamt\")!=null||document.getElementById(\"checkamt\")!=null){       \tvar checkamt=document.all(\"checkamt\").value;       \tif (checkamt==null||checkamt==\"\"){       \t\tcheckamt=\"0\";       \t\t}       \tif (parseFloat(value3)-parseFloat(checkamt)<0){       \t\talert(\"核销金额大于总金额，请重新核销！\");       \t\treturn;       \t\t}       \tdocument.all(\"factgetamt\").value=parseFloat(value3)-parseFloat(checkamt);       \t      }             ";
echo "               document.all.form1.paymoney.value=value3;       form1.flag.value=\"secorderaddnew\";       if(value_empty(\"FLD_MUST_STR\",\"FLD_NAME_STR\"))          return (false);       form1.submit();    }    function secamtupdate()    {    \t var i=0;          var tableName=document.all(\"Update_table\").value;       var dataCount=document.all(\"dataCount\").value;       //alert(dataCount);       var idValue=\"id_stockinid_id_1_wxdi";
echo "d_\";       if (tableName==\"getmain\")       {       idValue=\"id_stockoutid_id_1_wxdid_\";\t       }       var idValue2=\"thispaymoney_\";              var dataArea=dataId.innerHTML;       var dataClient=clientArea.innerHTML;       var dataLast=\"\";       if (tableName==\"getmain\")       {       dataLast=dataClient.lastIndexOf(\"id_stockoutid_id_1_wxdid\");       }else{       dataLast=dataClient.lastIndexOf(\"id_stockinid_id_1_wxdid\");";
echo "       }       var dataLast2=dataClient.indexOf(\"thispaymoney_\");                  var int2=dataClient.substring(dataLast2+13,dataLast2+14);              var value1;       var value2;       var value3=0;              for (i=1;i<=dataCount;i++){  \t       if (tableName==\"getmain\")       {       idValue=idValue.substring(0,25)+i;         }else{       idValue=idValue.substring(0,24)+i;         }       //alert(\"idValue\"+idValue);       idVa";
echo "lue2=idValue2.substring(0,13)+i;       if (i==1){       if (tableName==\"getmain\")       {       value1=document.all.form1.id_stockoutid_id_1_wxdid_1.value;       }else{       value1=document.all.form1.id_stockinid_id_1_wxdid_1.value;       }       }else{       value1=document.all(idValue).value;       }       //alert(\"value1\"+value1);       if (i==1){       value2=document.all.form1.thispaymoney_1.value;       }else{       val";
echo "ue2=document.all(idValue2).value;       }       //alert(\"value2\"+value2);           if (value1==null||value1==\"\"){       \talert(\"请在第\"+i+\"行第1列通过双击选择商品信息\");       \treturn;       \t}          if (value2==null||value2==\"\"){       \talert(\"请在第\"+i+\"行第4列输入金额\");       \treturn;       \t}       \tvar sStr=/,/g;             value2=value2.replace(sStr,\"\");         value3=value3+parseFloat(value2);          }       if";
echo " (document.getElementById(\"factgetamt\")!=null||document.getElementById(\"checkamt\")!=null){       \tvar checkamt=document.all(\"checkamt\").value;       \tif (checkamt==null||checkamt==\"\"){       \t\tcheckamt=\"0\";       \t\t}       \tif (parseFloat(value3)-parseFloat(checkamt)<0){       \t\talert(\"核销金额大于总金额，请重新核销！\");       \t\treturn;       \t\t}       \tdocument.all(\"factgetamt\").value=parseFloat(value3)-parseFloat(";
echo "checkamt);       \t      }                            document.all.form1.paymoney.value=value3;    \t    \t       if(value_empty(\"FLD_MUST_STR\",\"FLD_NAME_STR\"))          return (false);                 form1.flag.value=\"secorderupdate\";       form1.submit();    }    function clickDeleteUpdateRow() {        tmpStr = clientArea.innerHTML;        dataTemStr = dataId.innerHTML;                    deleteUpdateClienArea();      }    function secor";
echo "deraddnew()    {       if(value_empty(\"FLD_MUST_STR\",\"FLD_NAME_STR\"))          return (false);       form1.flag.value=\"secorderaddnew\";       var i=0;       var idValue=\"id_productid_id_1_wxdid_\";       var idValue2=\"plannum_\";       var dataArea=dataId.innerHTML;       var dataClient=clientArea.innerHTML;       var dataLastf=dataClient.lastIndexOf(\"name=dataNo\");       var dataLastl=dataClient.lastIndexOf(\"><INPUT type";
echo "=hidden value=\");       var dataLast=dataClient.lastIndexOf(\"id_productid_id_1_wxdid\");       var dataLast2=dataClient.indexOf(\"plannum_\");       var subLast=dataClient.substring(dataLastl+26,dataLastf);       var int1=dataClient.substring(dataLast+24,dataLast+25);       var int2=dataClient.substring(dataLast2+8,dataLast2+9);       //alert(\"dataLast\"+dataLast);       //alert(\"int1\"+int1);       int1=subLast;       ";
echo "if(dataLast==-1){       \tint1=1;       \t}       var value1       var value2         var nextMoney;       var countMoney=0;       var dataCount=document.form1(\"dataCount\").value;       var ModuleId=document.form1(\"ModuleId\").value;       //alert(\"dataCount:\"+dataCount);       if (dataCount!=null&&dataCount!=\"\"){       \tint1=dataCount;       \t}       for (i=1;i<=int1;i++){       idValue=idValue.substring(0,24)+i;         idValue2";
echo "=idValue2.substring(0,8)+i;       if (i==1){       value1=document.all.form1.id_productid_id_1_wxdid_1.value;       }else{       value1=document.all(idValue).value;       }       if (i==1){       value2=document.all.form1.plannum_1.value;       }else{       value2=document.all(idValue2).value;       }           if (value1==null||value1==\"\"){       \talert(\"请在第\"+i+\"行第1列通过双击选择商品信息\");       \treturn;       \t}       ";
echo "\t       \t          if (value2==null||value2==\"\"){       \talert(\"请在第\"+i+\"行第4列输入商品数量\");       \t       \treturn;      }else{      \tplanNum=parseFloat(value2);      \t//alert(\"planNum\"+planNum);      \t      \tif (isNaN(planNum)){      \talert(\"请输入正确的数量\");      \treturn;      }            \t}       \t       var planNum=document.form1(\"plannum_\"+i).value;                 if (document.getElementById(\"storenum_\"+i)!=null){       va";
echo "r storenumNum=document.form1(\"storenum_\"+i).value;       var storenumNumFlo=parseFloat(storenumNum);       if (isNaN(storenumNumFlo)){       \tstorenumNum=\"0\";       \tdocument.form1(\"storenum_\"+i).value=\"0\";      }              \tif (parseFloat(planNum)>parseFloat(storenumNum)&&(ModuleId==\"S04\"||ModuleId==\"S17\")){       \t\tvar alertName=\"\";       \t\tif (ModuleId==\"S04\"){       \t\t\talertName=\"出库\";       \t\t}else if (ModuleI";
echo "d==\"S17\"){       \t\t\talertName=\"需求\";       \t\t}       \t\tif(!window.confirm(\"商品  \"+value1+\"  \"+alertName+\"数量大于库存数量,把\"+alertName+\"数量修改为库存数量吗？\")){       \t\t\tif (outType==\"1\"){       \t\t\tdocument.form1(\"plannum_\"+i).value=\"0\";       \t\t}          return false;        }else{        \tdocument.form1(\"plannum_\"+i).value=storenumNum;        \t}           \t\t}      }                    if (document.getElementById(\"freenum";
echo "_\"+i)!=null){       var freeNum=document.form1(\"freenum_\"+i).value;       var freeNumFlo=parseFloat(freeNum);       if (isNaN(freeNumFlo)){       \tfreeNum=\"0\";       \tdocument.form1(\"freenum_\"+i).value=\"0\";      }              \tdocument.form1(\"allnum_\"+i).value=parseFloat(freeNum)+parseFloat(planNum);      }                            if (document.getElementById(\"price_\"+i)!=null){       var planPrice=document.form1(\"price_\"";
echo "+i).value;       if (planPrice!=null){       \tplanPrice=planPrice.replace(\",\",\"\");       \t}              if (isNaN(planPrice)){       \tdocument.form1(\"price_\"+i).value=\"0\";       \t}       init_value_order(\"plannum_\"+i);          init_value_order(\"price_\"+i);       init_value_order(\"money_\"+i);\t              nextMoney=parseFloat(document.form1(\"plannum_\"+i).value)*parseFloat(document.form1(\"price_\"+i).value);       if (isNa";
echo "N(nextMoney)){       \tnextMoney=\"0\";       \t}       \tdocument.form1(\"money_\"+i).value=nextMoney;       \taddMoneyStr(\"money_\"+i);       if (nextMoney!=null&&nextMoney!=\"\"){         //if (nextMoney.indexOf(\",\")>0){      \t //  nextMoney=nextMoney.replace(\",\",\"\");        // }\t       countMoney=countMoney+parseFloat(nextMoney);       }       //alert(\"countMoney\"+countMoney);      }       }       if (document.getElementById(\"amt\")";
echo "!=null){         var sendAmt=\"0\";       if (document.getElementById(\"sendAmt\")!=null){       \tsendAmt=document.form1(\"sendAmt\").value;       \tif (sendAmt==null||sendAmt==\"\"){       \t\tsendAmt=\"0\";       \t\t}       \t\tif (sendAmt.indexOf(\",\")>0){      \t   sendAmt=sendAmt.replace(/,/g,\"\");           }\t       \t\taddMoneyStr(\"sendAmt\");       \t}           \tdocument.form1(\"factpayamt\").value=countMoney-parseFloat(sendAmt);       docu";
echo "ment.form1(\"amt\").value=countMoney;       //针对付款和实际付款的处理       var planAmt=document.form1(\"amt\").value;              if (planAmt==null){       \tplanAmt=\"\";       \t}       \tif (document.getElementById(\"rebate\")!=null){          \tvar rebate=document.form1(\"rebate\").value;          \tplanAmt=countMoney*(parseFloat(rebate)/10);          \t}       if (planAmt!=\"\"){       \t         document.form1(\"factpayamt\").value=pl";
echo "anAmt-parseFloat(sendAmt);                  //针对税金的处理         if (document.getElementById(\"isfax\")!=null&&document.getElementById(\"noFaxAmt\")!=null){          \tvar faxRate=document.form1(\"isfax\").value;          \tif (faxRate==\"\"||faxRate==null){          \t\tfaxRate=\"0\";          \t\t}          \tvar noFaxAmt=countMoney/(1+parseFloat(faxRate));          \tdocument.form1(\"noFaxAmt\").value=noFaxAmt;          \taddMoney";
echo "Str(\"noFaxAmt\");          \t}                              \t}              var xiaoxieAmt=form1.amt.value;    \t var daxieAmt=atoc(xiaoxieAmt);    \t form1.chinaAmt.value=daxieAmt;       \t     \t addMoneyStr(\"amt\");       addMoneyStr(\"factpayamt\");\t    \t}       form1.submit();    }        function check_send(field)    {       var obj=document.all(field);       if(obj.value==\"\")          return;       var allamt=document.all(\"amt\").value;     ";
echo "        var thisamt=obj.value;           if (allamt==\"\"||allamt==null){       \tallamt=\"0\";       \t}else{       \t\tif (allamt.indexOf(\",\")>0){      \t   allamt=allamt.replace(/,/g,\"\");           }         }        if (thisamt.indexOf(\",\")>0){      \t   thisamt=thisamt.replace(/,/g,\"\");           }       \tvar rebate=\"0\";       if (document.getElementById(\"rebate\")!=null){          \trebate=document.form1(\"rebate\").value;        }\t      ";
echo " // document.all(\"amt\").value=parseFloat(allamt)*(1-parseFloat(rebate))-parseFloat(thisamt);       // planAmt=countMoney*(1-parseFloat(rebate));       document.all(\"factpayamt\").value=parseFloat(allamt)*(parseFloat(rebate)/10)-parseFloat(thisamt);              addMoneyStr(field);       addNumberStr(field.replace(\"price\",\"plannum\"));       addMoneyStr(\"factpayamt\");    }        function checkRate(field)    {       var o";
echo "bj=document.all(field);       if(obj.value==\"\")          return;          //alert(\"allamt\"+field);       var allamt=document.all(\"amt\").value;       var thisRate=obj.value;       if (allamt==\"\"||allamt==null){       \tallamt=\"0\";       \t}else{       \t\tif (allamt.indexOf(\",\")>0){      \t   allamt=allamt.replace(/,/g,\"\");           }         }               \talert(\"allamt\"+allamt);       \tif (field==\"rebate\"){       document.all(\"fa";
echo "ctpayamt\").value=parseFloat(allamt)*(parseFloat(thisRate)/10);       addMoneyStr(\"factpayamt\");       }       if (field==\"isfax\"){       \tif (thisRate==\"\"||thisRate==null){          \t\tthisRate=\"0\";          \t\t}       document.all(\"noFaxAmt\").value=parseFloat(allamt)/(1+parseFloat(thisRate));       addMoneyStr(\"noFaxAmt\");       }    }    function secorderupdate()    {       if(value_empty(\"FLD_MUST_STR\",\"FLD_NAME_STR\"))     ";
echo "     return (false);         form1.flag.value=\"secorderupdate\";              var i=0;       var idValue=\"id_productid_id_1_wxdid_\";       var idValue2=\"plannum_\";       var dataArea=dataId.innerHTML;       var dataClient=clientArea.innerHTML;       //alert(\"dataClient\"+dataClient);       var dataLast=dataClient.lastIndexOf(\"id_productid_id_1_wxdid\");       var dataLast2=dataClient.indexOf(\"plannum_\");           var int1=";
echo "dataClient.substring(dataLast+24,dataLast+25);       var int2=dataClient.substring(dataLast2+8,dataLast2+9);       if(dataLast==-1){       \tint1=1;       \t}       var value1       var value2         var nextMoney;       var countMoney=0;       var dataCount=document.form1(\"dataCount\").value;       var ModuleId=document.form1(\"ModuleId\").value;       //alert(\"dataCount:\"+dataCount);       if (dataCount!=null&&dataCount!=\"";
echo "\"){       \tint1=dataCount;       \t}       \t       for (i=1;i<=int1;i++){       idValue=idValue.substring(0,24)+i;         idValue2=idValue2.substring(0,8)+i;       if (i==1){       value1=document.all.form1.id_productid_id_1_wxdid_1.value;       }else{       value1=document.all(idValue).value;       }       if (i==1){       value2=document.all.form1.plannum_1.value;       }else{       value2=document.all(idValue2).value;       }\r";
echo "\n       if (value1==null||value1==\"\"){       \talert(\"请在第\"+i+\"行第1列输入商品信息\");       \treturn;       \t}          if (value2==null||value2==\"\"){       \talert(\"请在第\"+i+\"行第4列输入商品数量\");       \treturn;       \t}       \t       var planNum=document.form1(\"plannum_\"+i).value;            //alert(planNum);       if (document.getElementById(\"freenum_\"+i)!=null){       var freeNum=document.form1(\"freenum_\"+i).value;     ";
echo "  //var allNum=document.form1(\"allnum_\"+i).value;       //if (freeNum=null||freeNum=\"\")       //{       //\tfreeNum=\"0\";       //\t}       \t//alert(freeNum);       \t//alert(planNum);       \tdocument.form1(\"allnum_\"+i).value=parseFloat(freeNum)+parseFloat(planNum);       \t      }             if (document.getElementById(\"price_\"+i)!=null){       var planPrice=document.form1(\"price_\"+i).value;       if (planPrice!=null){       \tp";
echo "lanPrice=planPrice.replace(/,/g,\"\");       \t}       if (planPrice==null||planPrice==\"\"){       \tdocument.form1(\"price_\"+i).value=\"0\";       }              if (isNaN(planPrice)){       \tdocument.form1(\"price_\"+i).value=\"0\";       \t//alert(\"planPrice\"+planPrice);       \t}       //\talert(\"c2ountMoney\"+document.form1(\"money_\"+i).value);       init_value_order(\"plannum_\"+i);          init_value_order(\"price_\"+i);       init_val";
echo "ue_order(\"money_\"+i);\t       //alert(\"icountMoney\"+i);       nextMoney=parseFloat(document.form1(\"plannum_\"+i).value)*parseFloat(document.form1(\"price_\"+i).value);       //alert(\"countMoney\"+countMoney);       //alert(\"c1ountMoney\"+document.form1(\"money_\"+i).value);       if (isNaN(nextMoney)){       \tnextMoney=\"0\";       \t}       \tdocument.form1(\"money_\"+i).value=nextMoney;       \taddMoneyStr(\"money_\"+i);\t       if ";
echo "(nextMoney!=null&&nextMoney!=\"\"){       countMoney=countMoney+parseFloat(nextMoney);       }       //alert(\"countMoney\"+countMoney);      }       }       //alert(\"countMoney\"+countMoney);       if (document.getElementById(\"amt\")!=null){       var sendAmt=\"0\";       if (document.getElementById(\"sendAmt\")!=null){       \tsendAmt=document.form1(\"sendAmt\").value;       \tif (sendAmt==null||sendAmt==\"\"){       \t\tsendAmt=\"0\";     ";
echo "  \t\t}       \tif (sendAmt.indexOf(\",\")>0){      \t   sendAmt=sendAmt.replace(/,/g,\"\");           }\t\t       \taddMoneyStr(\"sendAmt\");\t       \t}       \tdocument.form1(\"amt\").value=countMoney;       \tdocument.form1(\"factpayamt\").value=countMoney-parseFloat(sendAmt);       //针对付款和实际付款的处理       var planAmt=document.form1(\"amt\").value;       if (planAmt==null){       \tplanAmt=\"\";       \t}       \tif (planAmt.indexOf(\",\")";
echo ">0){      \t   planAmt=planAmt.replace(/,/g,\"\");           }\t       \tif (document.getElementById(\"rebate\")!=null){          \tvar rebate=document.form1(\"rebate\").value;          \tplanAmt=countMoney*(parseFloat(rebate)/10)          \t}       if (planAmt!=\"\"){         document.form1(\"factpayamt\").value=planAmt-parseFloat(sendAmt);                   //针对税金的处理         if (document.getElementById(\"isfax\")!=null&&documen";
echo "t.getElementById(\"noFaxAmt\")!=null){          \tvar faxRate=document.form1(\"isfax\").value;          \tif (faxRate==\"\"||faxRate==null){          \t\tfaxRate=\"0\";          \t\t}          \tvar noFaxAmt=countMoney/(1+parseFloat(faxRate));          \tdocument.form1(\"noFaxAmt\").value=noFaxAmt;          \taddMoneyStr(\"noFaxAmt\");          \t}                   \t}       \t                    var xiaoxieAmt=form1.amt.value;    \t var daxieAmt=ato";
echo "c(xiaoxieAmt);    \t     \t form1.chinaAmt.value=daxieAmt;       \t     \t  addMoneyStr(\"amt\");       addMoneyStr(\"factpayamt\");\t    \t}           form1.submit();    }    function secorderquery()    {       Qform1.qflag.value=\"secorderquery\";         Qform1.submit();    }    function doIn()    {          var idRowid=document.all(\"ID_STR\").value;\t       if(idRowid==\"\")       {          alert(\"请至少选中一项进行入库！\");          return false;    ";
echo "   }       idRowid=idRowid.substring(0,idRowid.length-1);          var ModuleId=document.all(\"ModuleId\").value;       URL=\"/doStock.jsp?mainrowid=\"+idRowid+\"&ModuleId=\"+ModuleId+\"&doState='0'\";       loc_x=254;       loc_y=162;      window.open(URL,\"qq\",\"menubar=0,toolbar=0,status=0,scrollbars=1,resizable=1,width=650px,height=250px,Top=\"+loc_y+\"px,Left=\"+loc_x+\"px\");    }    function doOut()    {          var idRowid";
echo "=document.all(\"ID_STR\").value;\t       if(idRowid==\"\")       {          alert(\"请至少选中一项进行出库！\");          return false;       }       idRowid=idRowid.substring(0,idRowid.length-1);          var ModuleId=document.all(\"ModuleId\").value;       URL=\"/outStock.jsp?mainrowid=\"+idRowid+\"&ModuleId=\"+ModuleId+\"&doState='1'\";       loc_x=254;       loc_y=162;      window.open(URL,\"qq\",\"menubar=0,toolbar=0,status=0,scrol";
echo "lbars=1,resizable=1,width=650px,height=250px,Top=\"+loc_y+\"px,Left=\"+loc_x+\"px\");    }    function stockin()    {       form1.flag.value=\"stockin\";       form1.submit();    }    function stockout()    {       form1.flag.value=\"stockout\";       form1.submit();    }    function dataClick(dataNo){    form1.hidDataNo.value=dataNo    }    function check_value_order(field)    {             if (field.indexOf(\"money\")>=0){       return;       }\r";
echo "\n          var moduleId=document.form1(\"ModuleId\").value;              var sStr=/freenum/g;       if (field.indexOf(\"freenum\")>=0){       \tvar thissStr=/freenum/g;       \tvar thisPlanNum=document.form1(field.replace(thissStr,\"plannum\")).value;       \tvar thisFreeNum=document.form1(field).value;   \t       \tif (thisPlanNum==null||thisPlanNum==\"\"){       \tthisPlanNum=\"0\";       \t}       \tif (thisFreeNum==null||thisFreeNum";
echo "==\"\"){       \tthisFreeNum=\"0\";       \t}   \t            if (isNaN(parseFloat(thisPlanNum))){               alert(\"请输入正确的数据\");            return;            }            if (isNaN(parseFloat(thisFreeNum))){               alert(\"请输入正确的数据\");            return;            }       \tdocument.form1(field.replace(thissStr,\"allnum\")).value=parseFloat(thisPlanNum)+parseFloat(thisFreeNum);       \t       \t\tvar fieldNo=f";
echo "ield.substring(field.lastIndexOf(\"_\")+1,field.length);       \t       \tvar stockStr=\"num_productid_id_1_wxdnum_\"+fieldNo;        var stocknum=document.form1(stockStr).value;        //alert(stockStr+\"该商品的出库数量大与库存数量\"+stocknum);                var thisNum=document.form1(field.replace(sStr,\"allnum\")).value;  //ModuleId        if (stocknum==null||stocknum==\"\"){        \tstocknum=thisNum;        \t}        \t//al";
echo "ert(field.replace(sStr,\"plannum\")+\"==\"+stocknum+\"===\"+thisNum);        if (parseFloat(stocknum)<parseFloat(thisNum)&&document.form1(\"ModuleId\").value==\"S04\")        {        \t//alert(document.form1(\"StockIsNeg\").value);        \tif (document.form1(\"StockIsNeg\").value==\"1\"){         var subnum=parseFloat(thisNum)-parseFloat(stocknum);                 alert(\"该商品的出库数量大与库存数量\"+subnum);        document.form";
echo "1(field.replace(sStr,\"plannum\")).value=\"0\";        document.form1(field.replace(sStr,\"allnum\")).value=\"0\";        document.form1(field.replace(sStr,\"freenum\")).value=\"0\";        }        //return;        }               \t}              var obj=document.form1(field);       sStr=/price/g;       var fieldInt=field.indexOf(\"price\");       if (fieldInt>=0){       var fieldNum2=\"\";       var fieldNum=field.substring(6,field.length";
echo ");       var dataCount=document.form1(\"dataCount\").value;       //alert(\"dataCount\"+dataCount);          if (dataCount!=null&&dataCount!=\"\"){       \tfieldNum=dataCount;       \t}                     if (fieldNum2==\"\"){       fieldNum2=fieldNum;       }else if (fieldNum2>fieldNum){       fieldNum=fieldNum2;       }else if (fieldNum>fieldNum2){       fieldNum2=fieldNum;       }       //alert(\"业务数据的fieldNum2\"+fieldNum2);       ";
echo "  //针对赠品出库的处理              var rateStr=\"num_productid_id_1_wxdrate_\"+fieldNum2;       if (field.indexOf(\"price\")>=0&&(moduleId==\"S02\"||moduleId==\"S04\")){       var thisPlanNum=document.form1(field.replace(sStr,\"plannum\")).value;       if (thisPlanNum==null||thisPlanNum==\"\"){       \tthisPlanNum=\"0\";       \t}          if (isNaN(parseFloat(thisPlanNum))){               alert(\"请输入正确的数据\");              do";
echo "cument.form1(field.replace(sStr,\"plannum\")).value=\"\";            return;            }       \tvar freenum=0;       \tvar allnum=0;       \t//alert(\"rateStr\"+rateStr);        var rateNum=document.form1(rateStr).value;             if (rateNum==null||rateNum==\"\"){       \trateNum=\"0\";       \t}       if (isNaN(parseFloat(rateNum))){               alert(\"商品的赠品率设置不正确\");       return;            }                //alert(\"rateNum";
echo "\"+rateNum);       \tfreenum=parseFloat(thisPlanNum)*parseFloat(rateNum);       \tallnum=parseFloat(thisPlanNum)*(parseFloat(rateNum)+1);        //alert(\"freenum\"+freenum);        //alert(\"allnum\"+allnum);        var freenumstr=freenum.toString();        if (freenumstr.indexOf(\".\")>=0){        \tfreenumstr=freenumstr.substring(0,freenumstr.indexOf(\".\"));        \t}        var allnumstr=allnum.toString();        if (allnum";
echo "str.indexOf(\".\")>=0){        \tallnumstr=allnumstr.substring(0,allnumstr.indexOf(\".\"));        \t}        \tif (document.form1(field.replace(sStr,\"freenum\")).value==null||document.form1(field.replace(sStr,\"freenum\")).value==\"\"){           document.form1(field.replace(sStr,\"freenum\")).value=freenumstr;       \t   document.form1(field.replace(sStr,\"allnum\")).value=allnumstr;          }else{          \t          \tdocumen";
echo "t.form1(field.replace(sStr,\"allnum\")).value=parseFloat(thisPlanNum)+parseFloat(document.form1(field.replace(sStr,\"freenum\")).value);          \t}       }                     //赠品处理结束              //alert(\"业务数据的fieldNum\"+fieldNum+\"dataCount\"+dataCount);                 var moneyField=field;        moneyField=moneyField.replace(sStr,\"money\");        if(obj.value==\"\"||obj.value==null){       \tdocument.form1(moneyF";
echo "ield).value=\"\";          return;        }               var perMoney=document.form1(moneyField).value;       document.form1(moneyField).value=\"\";       //alert(document.form1(field.replace(sStr,\"plannum\")).value);                 if (document.form1(field.replace(sStr,\"plannum\")).value==\"\"){       document.form1(field.replace(sStr,\"plannum\")).value=\"0\";       document.form1(moneyField).value=parseFloat(document.form1(";
echo "field.replace(sStr,\"plannum\")).value)*parseFloat(obj.value);//parseFloat(obj.value)\t       }else{ //num_productid_id_1_wxdnum_1       \t//alert(\"该商品的出库数量大与库存数量\");       \t//alert(\"1该商品的出库数量大与库存数量\"+field.length);       \t//alert(\"2该商品的出库数量大与库存数量\"+field.lastIndexOf(\"_\"));       \tvar fieldNo=field.substring(field.lastIndexOf(\"_\")+1,field.length);       \t       \tvar stockStr=\"";
echo "num_productid_id_1_wxdnum_\"+fieldNo;        var stocknum=document.form1(stockStr).value;        //alert(stockStr+\"该商品的出库数量大与库存数量\"+stocknum);                if (document.getElementById(field.replace(sStr,\"allnum\"))!=null){        var thisNum=document.form1(field.replace(sStr,\"allnum\")).value;  //ModuleId                        if (stocknum==null||stocknum==\"\"){        \tstocknum=thisNum;        \t}        }\r";
echo "\n    \t//alert(field.replace(sStr,\"plannum\")+\"==\"+stocknum+\"===\"+thisNum);        if (parseFloat(stocknum)<parseFloat(thisNum)&&document.form1(\"ModuleId\").value==\"S04\")        {        \t//alert(document.form1(\"StockIsNeg\").value);        \tif (document.form1(\"StockIsNeg\").value==\"1\"){         var subnum=parseFloat(thisNum)-parseFloat(stocknum);                 alert(\"该商品的出库数量大与库存数量\"+subnum);        doc";
echo "ument.form1(field.replace(sStr,\"plannum\")).value=\"0\";        document.form1(field.replace(sStr,\"allnum\")).value=\"0\";        document.form1(field.replace(sStr,\"freenum\")).value=\"0\";        }        //return;        }       //alert(\"该商品的出库数量大与库存数量2\"+document.form1(field.replace(sStr,\"plannum\")).value);       //alert(\"该商品的出库数量大与库存数量3\"+obj.value);       document.form1(moneyField).value=par";
echo "seFloat(document.form1(field.replace(sStr,\"plannum\")).value)*parseFloat(obj.value);//parseFloat(obj.value)\t       }                     if (document.form1(\"amt\").value==\"\"){       document.form1(\"amt\").value=document.form1(moneyField).value;       }else{       var i=0;       var nextMoney;       var countMoney=0;       for (i=1;i<=fieldNum;i++)       {       init_value_order(\"money_\"+i);   \t       nextMoney=document.form1(\"";
echo "money_\"+i).value;       if (nextMoney!=null&&nextMoney!=\"\"){       countMoney=countMoney+parseFloat(nextMoney);       }       }          document.form1(\"amt\").value=countMoney       //alert(\"前\"+document.form1(moneyField).value);       addMoneyStr(moneyField);              //alert(\"后\"+document.form1(moneyField).value);              }              //alert(document.form1(moneyField).value);       //针对付款和实际付款的处理     ";
echo "  planAmt=document.form1(\"amt\").value;       if (planAmt==null){       \tplanAmt=\"\";      }else{      \t   if (planAmt.indexOf(\",\")>0){      \t   planAmt=planAmt.replace(/,/g,\"\");           }      \t}        sendAmt=\"0\";       //针对运费的处理         if (document.getElementById(\"sendAmt\")!=null){       \tvar sendAmt=document.form1(\"sendAmt\").value;       \tif (sendAmt==null||sendAmt==\"\"){       \t\tsendAmt=\"0\";       \t\t}       \tvar s";
echo "endAmtDou=parseFloat(sendAmt);       \tdocument.form1(\"factpayamt\").value=parseFloat(planAmt)-parseFloat(sendAmt);       \tplanAmt=document.form1(\"amt\").value;       \tif (planAmt==null){       \tplanAmt=\"\";        }else{        \t//alert(\"planAmt\"+planAmt+\"indexOf\"+planAmt.indexOf(\",\"));      \t   if (planAmt.indexOf(\",\")>0){      \t   planAmt=planAmt.replace(/,/g,\"\");           }      \t}       \taddMoneyStr(\"sendAmt\");       \t";
echo "       \t}       \tif (document.getElementById(\"rebate\")!=null){          \tvar rebate=document.form1(\"rebate\").value;          \tif (rebate==null||rebate==\"\"){          \t\trebate=\"0\";          \t\t}          \tplanAmt=parseFloat(planAmt)*(parseFloat(rebate)/10)-parseFloat(sendAmt);          \t}               \tif (planAmt!=\"\"){         document.form1(\"factpayamt\").value=planAmt;         \tplanAmt=document.form1(\"amt\").value;       \t";
echo "if (planAmt==null){       \tplanAmt=\"\";        }else{      \t   if (planAmt.indexOf(\",\")>0){      \t   planAmt=planAmt.replace(/,/g,\"\");           }      \t}              //针对税金的处理         if (document.getElementById(\"isfax\")!=null&&document.getElementById(\"noFaxAmt\")!=null){          \tvar faxRate=document.form1(\"isfax\").value;          \tif (faxRate==\"\"||faxRate==null){          \t\tfaxRate=\"0\";          \t\t}          \tvar n";
echo "oFaxAmt=parseFloat(planAmt)/(1+parseFloat(faxRate))          \tdocument.form1(\"noFaxAmt\").value=noFaxAmt;          \taddMoneyStr(\"noFaxAmt\");          \t}            \t}       //\talert(\"前\"+document.form1(field.replace(\"price\",\"plannum\")).value);       addMoneyStr(\"amt\");       addMoneyStr(\"factpayamt\");       addNumberStr(field.replace(\"price\",\"plannum\"));      //alert(\"后\"+document.form1(moneyField).value);      // \tal";
echo "ert(planAmt);       if(obj.value.substring(0,1)==\"-\")       {       \t   op=\"-\";       \t   obj.value=obj.value.substring(1,obj.value.length);       }       else           op=\"\";       val=parseFloat(obj.value);                 if(isNaN(val))       {          alert(\"非法的数字\");          obj.focus();          return;       }       obj.value=ForDight(val,amtdot);          var value_array=obj.value.split(\".\");       //格式化整数位       ";
echo "start=0;       len=0;       val_int=\"\";       while(1)       {       \t  if((value_array[0].length-start)%3==0)       \t     len=3;       \t  else       \t  \t len=value_array[0].length%3;              if(val_int==\"\")             val_int=value_array[0].substring(start,start+len);          else             val_int=val_int+\",\"+value_array[0].substring(start,start+len);       \t  start=len+start;           \t  if(start>=value_array[0].len";
echo "gth)       \t     break;       }       if(val_int!=\"\")          value_array[0]=val_int;       if(value_array.length==1)       \t  value_array[1]=\"00\";       else if(value_array.length==amtdot)       {       \t  if(value_array[1].length==0)       \t    value_array[1]=\"00\";       \t  else if(value_array[1].length==1)       \t    value_array[1]=value_array[1]+\"0\";       \t  else if(value_array[1].length>=amtdot)       \t    value_array";
echo "[1]=value_array[1].substr(0,amtdot);       }       obj.value=op+value_array[0]+\".\"+value_array[1];             }    }    function  init_value_order(field)    {       var obj=document.form1(field);           if (obj.value==\"\"||obj.value==null)          return;       re=/,/g;       obj.value=obj.value.replace(re,\"\");    }            function check_value_amt(field)    {       var obj=document.form1(field);       if(obj.value==\"\"||obj.value";
echo "==null)          return;              if (field.indexOf(\"allpaymoney_\")>=0){       \t return;       \t}       \tif (field.indexOf(\"haspaymoney_\")>=0){       \t return;       \t}       \t//alert(field);       var oldAmt=document.form1(\"tempAmt\").value;       var allAmt=document.form1(\"paymoney\").value;          var newAmt=obj.value;       //alert(\"测试点：\"+fieldNum);       //alert(\"就金额\"+oldAmt+\"新金额\"+obj.value+\"总金额\"+allAmt";
echo ");       var fieldNo=field.substring(field.lastIndexOf(\"_\")+1,field.length);       //alert(\"测试点：\"+fieldNo);       var allAmtName=\"allpaymoney_\"+fieldNo;       var hasAmtName=\"haspaymoney_\"+fieldNo;              var thisAllAmt=document.form1(allAmtName).value;        var thishasAmt=document.form1(hasAmtName).value;        var moduelId=document.form1(moduelId).value;       thisAllAmt=subsymb(thisAllAmt);       this";
echo "hasAmt=subsymb(thishasAmt);       var toPayAmt=parseFloat(thisAllAmt)-parseFloat(thishasAmt);       var thisSubAmt=parseFloat(newAmt)-toPayAmt;       if (thisSubAmt>0)       {        if(!window.confirm(\"本次付款金额大于应付款金额:\"+thisSubAmt+\",继续进行吗？\"))          {          document.form1(field).value=addsymb(parseFloat(oldAmt));          return false;          }       }              allAmt=subsymb(allAmt);       old";
echo "Amt=subsymb(oldAmt);              var tempAmt=parseFloat(allAmt)-parseFloat(oldAmt)+parseFloat(newAmt);       allAmt=addsymb(tempAmt);       document.form1(\"paymoney\").value=allAmt;       document.form1(field).value=addsymb(parseFloat(newAmt));    }        function  init_value_amt(field)    {       var obj=document.form1(field);           if (obj.value==\"\"||obj.value==null)          return;       re=/,/g;       obj.value=obj.v";
echo "alue.replace(re,\"\");              document.form1(\"tempAmt\").value=obj.value;//临时金额    }        function addsymb(fieldValue)    {    \tfieldValue=fieldValue.toString();       if(fieldValue==\"\")          return;              if(fieldValue.substring(0,1)==\"-\")       {       \t   op=\"-\";       \t   fieldValue=fieldValue.substring(1,fieldValue.length);       }       else           op=\"\";                  val=parseFloat(fieldValue);       if";
echo "(isNaN(val))       {          alert(\"非法的数字\");          return;       }          if(fieldValue.indexOf(\".\")<0){      \tfieldValue=fieldValue+\".00\";      \t}            var value_array=fieldValue.split(\".\");               start=0;       len=0;       val_int=\"\";                   while(1)       {       \t  if((value_array[0].length-start)%3==0)       \t     len=3;       \t  else       \t  \t len=value_array[0].length%3;              if(val_int==\"\")      ";
echo "       val_int=value_array[0].substring(start,start+len);          else             val_int=val_int+\",\"+value_array[0].substring(start,start+len);       \t  start=len+start;           \t  if(start>=value_array[0].length)       \t     break;       }       if(val_int!=\"\")          value_array[0]=val_int;           //格式化小数位       if(value_array.length==1)       \t  value_array[1]=\"00\";       else if(value_array.length==amtdot";
echo ")       {       \t  if(value_array[1].length==0)       \t    value_array[1]=\"00\";       \t  else if(value_array[1].length==1)       \t    value_array[1]=value_array[1]+\"0\";       \t  else if(value_array[1].length>=amtdot)       \t    value_array[1]=value_array[1].substr(0,amtdot);       }           fieldValue=op+value_array[0]+\".\"+value_array[1];            return fieldValue;    }        function  subsymb(fieldValue)    {       if (fiel";
echo "dValue==\"\")          return;           re=/,/g;       fieldValue=fieldValue.replace(re,\"\");              return fieldValue;    }    function atoc(numberValue){        var numberValue=new String(Math.round(numberValue*100)); // 数字金额      var chineseValue=\"\";          // 转换后的汉字金额      var String1 = \"零壹贰叁肆伍陆柒捌玖\";       // 汉字数字      var String2 = \"万仟佰拾亿仟佰拾万仟佰拾元角分\";     // 对应单位      ";
echo "var len=numberValue.length;         // numberValue 的字符串长度      var Ch1;             // 数字的汉语读法      var Ch2;             // 数字位的汉字读法      var nZero=0;            // 用来计算连续的零值的个数      var String3;            // 指定位置的数值      if(len>15){       alert(\"超出计算范围\");       return \"\";      }      if (numberValue==0){          chineseValue = \"零元整\";       return chineseValue;         }";
echo "        String2 = String2.substr(String2.length-len, len);   // 取出对应位数的STRING2的值            for(var i=0; i<len; i++){              String3 = parseInt(numberValue.substr(i, 1),10);   // 取出需转换的某一位的值       //alert(String3);       if ( i != (len - 3) && i != (len - 7) && i != (len - 11) && i !=(len - 15) ){                if ( String3 == 0 ){                  Ch1 = \"\";         Ch2 = \"\";         nZero = nZero";
echo " + 1;                 }else if ( String3 != 0 && nZero != 0 ){                  Ch1 = \"零\" + String1.substr(String3, 1);         Ch2 = String2.substr(i, 1);         nZero = 0;                 }else{                  Ch1 = String1.substr(String3, 1);         Ch2 = String2.substr(i, 1);         nZero = 0;        }       }else{              // 该位是万亿，亿，万，元位等关键位        if( String3 != 0 && nZero != 0 ){                  ";
echo "Ch1 = \"零\" + String1.substr(String3, 1);         Ch2 = String2.substr(i, 1);         nZero = 0;                 }else if ( String3 != 0 && nZero == 0 ){                  Ch1 = String1.substr(String3, 1);         Ch2 = String2.substr(i, 1);         nZero = 0;                 }else if( String3 == 0 && nZero >= 3 ){                  Ch1 = \"\";         Ch2 = \"\";         nZero = nZero + 1;                 }else{                  Ch1 = \"\";";
echo "         Ch2 = String2.substr(i, 1);         nZero = nZero + 1;                 }                if( i == (len - 11) || i == (len - 3)) {    // 如果该位是亿位或元位，则必须写上         Ch2 = String2.substr(i, 1);        }               }       chineseValue = chineseValue + Ch1 + Ch2;             }            if ( String3 == 0 ){           // 最后一位（分）为0时，加上“整”       chineseValue = chineseValue + \"整\";      }            re";
echo "turn chineseValue;     }          function addMoneyStr(moneyField){     \t     \t  if (document.form1(moneyField).value.indexOf(\",\")>=0){     \t  \treturn;     \t  \t}     \t       if(document.form1(moneyField).value==\"\")          return;        if(document.form1(moneyField).value.substring(0,1)==\"-\")       {       \t   op_Money=\"-\";       \t   document.form1(moneyField).value=document.form1(moneyField).value.substring(1,document.for";
echo "m1(moneyField).value.length);       }       else           op_Money=\"\";                   val_Money=parseFloat(document.form1(moneyField).value);           document.form1(moneyField).value=ForDight(val_Money,amtdot);        var value_array_Money=document.form1(moneyField).value.split(\".\");           start_Money=0;       len_Money=0;       val_int_Money=\"\";           while(1)       {       \t  if((value_array_Money[0].length-sta";
echo "rt_Money)%3==0)       \t     len_Money=3;       \t  else       \t  \t len_Money=value_array_Money[0].length%3;              if(val_int_Money==\"\")             val_int_Money=value_array_Money[0].substring(start_Money,start_Money+len_Money);          else             val_int_Money=val_int_Money+\",\"+value_array_Money[0].substring(start_Money,start_Money+len_Money);       \t  start_Money=len_Money+start_Money;           \t  if(st";
echo "art_Money>=value_array_Money[0].length)       \t     break;       }       if(val_int_Money!=\"\")          value_array_Money[0]=val_int_Money;           if(value_array_Money.length==1)       \t  value_array_Money[1]=amtdotValue;       else if(value_array_Money.length==amtdot)       {       \t  if(value_array_Money[1].length==0)       \t    value_array_Money[1]=amtdotValue;       \t  else if(value_array_Money[1].length==1)       \t";
echo "    value_array_Money[1]=value_array_Money[1]+\"0\";       \t  else if(value_array_Money[1].length>=amtdot)       \t    value_array_Money[1]=value_array_Money[1].substr(0,amtdot);       }              if (amtdot==0){       document.form1(moneyField).value=op_Money+value_array_Money[0];       }else {       document.form1(moneyField).value=op_Money+value_array_Money[0]+\".\"+value_array_Money[1];\t      }           \t}           fun";
echo "ction addNumberStr(moneyField){     \t     \t  if (document.form1(moneyField).value.indexOf(\",\")>=0){     \t  \treturn;     \t  \t}     \t       if(document.form1(moneyField).value==\"\")          return;        if(document.form1(moneyField).value.substring(0,1)==\"-\")       {       \t   op_Money=\"-\";       \t   document.form1(moneyField).value=document.form1(moneyField).value.substring(1,document.form1(moneyField).value.length);\r";
echo "\n   }       else           op_Money=\"\";                   val_Money=parseFloat(document.form1(moneyField).value);           document.form1(moneyField).value=ForDight(val_Money,numdot);                      \tvar value_array_Money=document.form1(moneyField).value.split(\".\");           start_Money=0;       len_Money=0;       val_int_Money=\"\";                  if(val_int_Money!=\"\")          value_array_Money[0]=val_int_Money;           ";
echo "if(value_array_Money.length==1)       \t  value_array_Money[1]=numdotValue;       else if(value_array_Money.length==numdot)       {       \t  if(value_array_Money[1].length==0)       \t    value_array_Money[1]=numdotValue;       \t  else if(value_array_Money[1].length==1)       \t    value_array_Money[1]=value_array_Money[1]+\"0\";       \t  else if(value_array_Money[1].length>=numdot)       \t    value_array_Money[1]=value";
echo "_array_Money[1].substr(0,numdot);       }       if (numdot==0){       document.form1(moneyField).value=op_Money+value_array_Money[0];       }else {       document.form1(moneyField).value=op_Money+value_array_Money[0]+\".\"+value_array_Money[1];\t      }           \t}    </script>                \t                        <meta http-equiv=\"Content-Type\" content=\"text/html; charset=gb2312\">     <link rel=\"stylesheet\" type=\"text/css\" href=\"../../th";
echo "eme/1/style.css\">                <html>    <head>    <title>采购计划管理窗口</title>    <meta http-equiv=\"Content-Type\" content=\"text/html; charset=gb2312\">     ";
echo "<s";
echo "cript>     function stockBack(num)    {        var backNum;        var backNumStr=\"backnum\";        var backAmtStr=\"backamt\";        var countNum=0;        var countAmt=0;        for (i=1;i<=num;i++){        backNumStr=\"backnum\"+i;            backNum=document.all(backNumStr).value;        //document.all(backNumStr).value        if (backNum!=\"\"&&backNum!=null){        countNum=countNum+parseFloat(backNum);        }        }       ";
echo " if (countNum==0){        alert(\"请确定入库数量!\");        return (false);        }                    var thisAllAmt;    var thisAddNum;    var resAllAmt=document.form1(\"countAllAmt\").value;    if (resAllAmt==null||resAllAmt==\"\"){    \tresAllAmt=\"0\";    \t}    var folAllAmt=0;        var resAllNum=document.form1(\"countNum\").value;    if (resAllNum==null||resAllNum==\"\"){    \tresAllNum=\"0\";    \t}    var folAllNum=0;        for (var i=1;i<=n";
echo "um;i++){        \tthisAddNum=document.form1(\"backnum\"+i).value;      thisAllAmt=document.form1(\"backallamt\"+i).value;      thisAllAmt=thisAllAmt.replace(\",\",\"\");\t      if (thisAddNum==null||thisAddNum==\"\"){    \tthisAddNum=\"0\";    \t}    \tif (thisAllAmt==null||thisAllAmt==\"\"){    \tthisAllAmt=\"0\";    \t}          folAllAmt=folAllAmt+parseFloat(thisAllAmt);    \tfolAllNum=folAllNum+parseFloat(thisAddNum);    \t}    document.form1(\"cou";
echo "ntAllAmt\").value=folAllAmt;\t    document.form1(\"countNum\").value=folAllNum;            document.form1(\"chinaAmt\").value=atoc(folAllAmt);            addMoneyStr(\"countAllAmt\");                       form1.flag.value=\"stockBuyPlan\";       form1.submit();    }    function checkNum(numNo)    {            var num1=document.form1(\"7\"+numNo).value;//计划数量         var numCount=document.form1(\"num\").value;//总行数         var num2=doc";
echo "ument.form1(\"8\"+numNo).value; //到货数量        var numIn=document.form1(\"backnum\"+numNo).value;        if (document.form1(\"backamt\"+numNo).value==null||document.form1(\"backamt\"+numNo).value==\"\"){        document.form1(\"backamt\"+numNo).value=document.form1(\"9\"+numNo).value; //本次到货数量        }        //document.form1(\"backprice\"+numNo).value        if (numIn!=\"\"&&numIn!=null){        \t        \tif (num1==null|";
echo "|num1==\"\"){        \t\tnum1=\"0\";        \t\t}        \tif (num2==null||num2==\"\"){        \t\tnum2=\"0\";        \t\t}\t        if (numIn==null||numIn==\"\"){        \treturn false;        \t}        \tvar lastNum=parseFloat(num1)-parseFloat(num2);        if (lastNum<parseFloat(numIn)){         if(window.confirm(\"本次订单数量大于应订货数量,是否继续进行？\")){         //return false;          document.form1(\"backallamt\"+numNo).value=\"\";         ";
echo " document.form1(\"backamt\"+numNo).value=\"\";          document.form1(\"backnum\"+numNo).value=\"\";          }        }            var thisNum=document.form1(\"backnum\"+numNo).value;        var thisAmt=document.form1(\"backamt\"+numNo).value;           if (thisNum==null){        \t\tthisNum=\"\";        \t\t}        \t if (thisAmt==null){        \t\tthisAmt=\"\";        \t\t}        if(thisNum!=\"\"&&thisAmt!=\"\"){        thisAmt=thisAmt.replace(\",\"";
echo ",\"\");\t        document.form1(\"backallamt\"+numNo).value=parseFloat(thisNum)*parseFloat(thisAmt);                 addMoneyStr(\"backallamt\"+numNo);        addMoneyStr(\"backamt\"+numNo);        }    }        var thisAllAmt;    var thisAddNum;    var resAllAmt=document.form1(\"countAllAmt\").value;    if (resAllAmt==null||resAllAmt==\"\"){    \tresAllAmt=\"0\";    \t}    var folAllAmt=0;        var resAllNum=document.form1(\"countNum\").value;\r";
echo "\nif (resAllNum==null||resAllNum==\"\"){    \tresAllNum=\"0\";    \t}    var folAllNum=0;        for (var i=1;i<=numCount;i++){        \tthisAddNum=document.form1(\"backnum\"+i).value;      thisAllAmt=document.form1(\"backallamt\"+i).value;      thisAllAmt=thisAllAmt.replace(\",\",\"\");\t      if (thisAddNum==null||thisAddNum==\"\"){    \tthisAddNum=\"0\";    \t}    \tif (thisAllAmt==null||thisAllAmt==\"\"){    \tthisAllAmt=\"0\";    \t}          folAllAmt=fol";
echo "AllAmt+parseFloat(thisAllAmt);    \tfolAllNum=folAllNum+parseFloat(thisAddNum);    \t}    document.form1(\"countAllAmt\").value=folAllAmt;\t    document.form1(\"countNum\").value=folAllNum;            document.form1(\"chinaAmt\").value=atoc(folAllAmt);            addMoneyStr(\"countAllAmt\");    }     </script>    </head>        <body class=\"bodycolor\">    <div align=\"center\">    <form name=\"form1\" action=\"?action=dataDeal\" method=\"post\">    <ta";
echo "ble border=\"0\" width=\"100%\" cellspacing=\"0\" cellpadding=\"3\" class=\"small\">      <tr>        <td class=\"Small1\" align=\"right\"><b><font color=\"#000000\">        \t<input   type=radio  name=\"isAddNum\"  checked  value=2   class=\"SmallInput\">数量合计    \t\t&nbsp&nbsp&nbsp&nbsp    \t\t<input   type=radio  name=\"isAddNum\"    value=1   class=\"SmallInput\">数量分开</font></b>        </td>      </tr>    </table>    <table border=\"0\" cellspaci";
echo "ng=\"1\" width=\"95%\" class=\"small\" bgcolor=\"#000000\" cellpadding=\"3\">    <tr align=\"center\" >              <td nowrap  class=\"TableHeader\" >编号</td>              <td nowrap  class=\"TableHeader\" >需求部门</td>              <td nowrap  class=\"TableHeader\" >计划日期</td>              <td nowrap  class=\"TableHeader\" >商品编码</td>              <td nowrap  class=\"TableHeader\" >商品名称</td>              <td nowrap  class=\"TableHeader\" >规格";
echo "</td>              <td nowrap  class=\"TableHeader\" >型号</td>              <td nowrap  class=\"TableHeader\" >计划数量</td>              <td nowrap  class=\"TableHeader\" >已定货数量</td>              <td nowrap  class=\"TableHeader\" >单价</td>              <td nowrap  class=\"TableHeader\" >备注</td>        <td nowrap  class=\"TableHeader\" >订单数量</td>    <td nowrap  class=\"TableHeader\" >订单单价</td>    <td nowrap  class=\"TableHeader\" >小计</td>";
echo "    </tr>        ";
echo "<?php";
echo "    \$sql = \"select requireplanmain.tablecode,    \t\tdepartment.DEPT_NAME,    \t\trequireplanmain.tabledate,    \t\trequireplandetail.productid,    \t\tproduct.productname,    \t\trequireplandetail.standard,    \t\trequireplandetail.mode,    \t\trequireplandetail.plannum,    \t\trequireplandetail.stockinfactnum,    \t\trequireplandetail.price,    \t\trequireplandetail.requireplandetailsign,    \t\trequireplandetail.requireplandetailsign,    \t\tr";
echo "equireplandetail.requireplandetailsign,    \t\trequireplandetail.requireplandetailsign,    \t\trequireplandetail.ROWID     \t\tfrom requireplandetail,     \t\trequireplanmain,    \t\tdepartment,    \t\tproduct     \t\twhere requireplandetail.mainrowid=requireplanmain.ROWID     \t\tand requireplanmain.stockid=department.DEPT_ID and    \t\trequireplandetail.productid=product.productid   and    \t\trequireplanmain.flowState='1'        \t\tand ";
echo "( requireplandetail.plannum>requireplandetail.stockinfactnum     \t\t\t\tor requireplandetail.dataState!='2' )      \t\torder by product.productid    \t\t\";    //print \$sql;    \$rs = \$db->Execute(\$sql);    \$rs_a = \$rs->GetArray();    for(\$i=0;\$i";
echo "<s";
echo "izeof(\$rs_a);\$i++)\t\t\t{    \$Element = \$rs_a[\$i];    \$MarkID = \$i+1;    ?>        <tr class=\"TableLine1\" id=\"TR10\" >        <td   align=\"left\" ><input readonly  type=\"text\"   name=\"0";
echo "<?php echo ";
echo "\$MarkID?>\" value=\"";
echo "<?php echo ";
echo "\$Element['tablecode']?>\" size=\"10\" maxlength=\"54\"  class=\"SmallInput2\"></td>        <td   align=\"left\" ><input readonly  type=\"text\"   name=\"1";
echo "<?php echo ";
echo "\$MarkID?>\" value=\"";
echo "<?php echo ";
echo "\$Element['DEPT_NAME']?>\" size=\"10\" maxlength=\"54\"  class=\"SmallInput2\"></td>        <td   align=\"left\" ><input readonly  type=\"text\"   name=\"2";
echo "<?php echo ";
echo "\$MarkID?>\" value=\"";
echo "<?php echo ";
echo "\$Element['tabledate']?>\" size=\"10\" maxlength=\"54\"  class=\"SmallInput2\"></td>        <td   align=\"left\" ><input readonly  type=\"text\"   name=\"3";
echo "<?php echo ";
echo "\$MarkID?>\" value=\"";
echo "<?php echo ";
echo "\$Element['productid']?>\" size=\"10\" maxlength=\"54\"  class=\"SmallInput2\"></td>        <td   align=\"left\" ><input readonly  type=\"text\"   name=\"4";
echo "<?php echo ";
echo "\$MarkID?>\" value=\"";
echo "<?php echo ";
echo "\$Element['productname']?>\" size=\"10\" maxlength=\"54\"  class=\"SmallInput2\"></td>        <td   align=\"left\" ><input readonly  type=\"text\"   name=\"5";
echo "<?php echo ";
echo "\$MarkID?>\" value=\"";
echo "<?php echo ";
echo "\$Element['standard']?>\" size=\"10\" maxlength=\"54\"  class=\"SmallInput2\"></td>        <td   align=\"left\" ><input readonly  type=\"text\"   name=\"6";
echo "<?php echo ";
echo "\$MarkID?>\" value=\"";
echo "<?php echo ";
echo "\$Element['mode']?>\" size=\"10\" maxlength=\"54\"  class=\"SmallInput2\"></td>        <td   align=\"left\" ><input readonly  type=\"text\"   name=\"7";
echo "<?php echo ";
echo "\$MarkID?>\" value=\"";
echo "<?php echo ";
echo "\$Element['plannum']?>\" size=\"10\" maxlength=\"54\"  class=\"SmallInput2\"></td>        <td   align=\"left\" ><input readonly  type=\"text\"   name=\"8";
echo "<?php echo ";
echo "\$MarkID?>\" value=\"";
echo "<?php echo ";
echo "\$Element['stockinfactnum']?>\" size=\"10\" maxlength=\"54\"  class=\"SmallInput2\"></td>        <td   align=\"right\" ><input readonly  type=\"text\"   name=\"9";
echo "<?php echo ";
echo "\$MarkID?>\" value=\"";
echo "<?php echo ";
echo "\$Element['price']?>\" size=\"10\" maxlength=\"54\"  class=\"SmallInput2\"></td>        <td   align=\"left\" ><input readonly  type=\"text\"   name=\"10";
echo "<?php echo ";
echo "\$MarkID?>\" value=\"";
echo "<?php echo ";
echo "\$Element['requireplandetailsign']?>\" size=\"10\" maxlength=\"54\"  class=\"SmallInput2\"></td>        <td  ><input   type=\"text\"   name=\"backnum";
echo "<?php echo ";
echo "\$MarkID?>\" size=\"10\" maxlength=\"54\"  onblur=\"checkNum('";
echo "<?php echo ";
echo "\$MarkID?>')\"  class=\"SmallInput2\"></td>    <td  ><input   type=\"text\"   name=\"backamt";
echo "<?php echo ";
echo "\$MarkID?>\" size=\"10\" maxlength=\"54\"  onblur=\"checkNum('";
echo "<?php echo ";
echo "\$MarkID?>')\"   class=\"SmallInput2\"></td>    <td  ><input   type=\"text\"   name=\"backallamt";
echo "<?php echo ";
echo "\$MarkID?>\" size=\"10\" maxlength=\"54\"   class=\"SmallInput2\"></td>    </tr>    <input type=\"hidden\" name=\"ROWID_";
echo "<?php echo ";
echo "\$MarkID?>\" value=\"";
echo "<?php echo ";
echo "\$Element['ROWID']?>\">            ";
echo "<?php";
echo "    \$All_plannum += \$Element['plannum'];    \$All_stockinfactnum += \$Element['stockinfactnum'];    \$All_price += \$Element['price'];        }//end for        ?>        <tr class=\"TableLine1\" id=\"TR\" style=\"cursor:pointer;\">    <td  class=\"TableHeader\">合计</td>        <td class=\"TableHeader\" align=\"left\">&nbsp</td>        <td class=\"TableHeader\" align=\"left\">&nbsp</td>        <td class=\"TableHeader\" align=\"left\">&nbsp</td>        <td class=\"TableH";
echo "eader\" align=\"left\">&nbsp</td>        <td class=\"TableHeader\" align=\"left\">&nbsp</td>        <td class=\"TableHeader\" align=\"left\">&nbsp</td>        <td class=\"TableHeader\" align=\"left\">";
echo "<?php echo ";
echo "\$All_plannum?></td>        <td class=\"TableHeader\" align=\"left\">";
echo "<?php echo ";
echo "\$All_stockinfactnum?></td>        <td  class=\"TableHeader\" align=\"right\">";
echo "<?php echo ";
echo "\$All_price?></td>        <td class=\"TableHeader\" align=\"left\">&nbsp</td>        <td class=\"TableHeader\" align=\"left\" >    \t<input   type=\"text\"   name=\"countNum\" size=\"10\" maxlength=\"54\"   class=\"SmallInput2\">    \t</td>    <td  class=\"TableHeader\" align=\"left\">    \t<input   type=\"text\"   name=\"countAmt\" size=\"10\" maxlength=\"54\"   class=\"SmallInput2\">    \t</td>    <td  class=\"TableHeader\" align=\"left\">    \t<input   type=\"text\"   n";
echo "ame=\"countAllAmt\" size=\"10\" maxlength=\"54\"   class=\"SmallInput2\">    \t</td>    </tr>    </table>    <input type=\"hidden\" name=\"rowid\" value=\"1\">    <input type=\"hidden\" name=\"num\" value=\"";
echo "<?php echo ";
echo "sizeof(\$rs_a)?>\">    <input type=\"hidden\" name=\"supplyId\" value=\"";
echo "<?php echo ";
echo "\$_GET['supplyId']?>\">    <input type=\"hidden\" name=\"ModuleId\" value=\"";
echo "<?php echo ";
echo "\$_GET['ModuleId']?>\">    <input type=\"hidden\" name=\"oldModuleId\" value=\"";
echo "<?php echo ";
echo "\$_GET['oldModuleId']?>\">    <input type=\"hidden\" name=\"tablecode\" value=\"";
echo "<?php echo ";
echo "\$_GET['tablecode']?>\">    <input type=\"hidden\" name=\"tabledate\" value=\"";
echo "<?php echo ";
echo "\$_GET['tabledate']?>\">    <input type=\"hidden\" name=\"stockid\" value=\"";
echo "<?php echo ";
echo "\$_GET['stockid']?>\">    <input type=\"hidden\" name=\"buyman\" value=\"";
echo "<?php echo ";
echo "\$_GET['buyman']?>\">    <input type=\"hidden\" name=\"intype\" value=\"";
echo "<?php echo ";
echo "\$_GET['intype']?>\">    <input type=\"hidden\" name=\"sendDate\" value=\"";
echo "<?php echo ";
echo "\$_GET['sendDate']?>\">    <input type=\"hidden\" name=\"stockinsign\" value=\"";
echo "<?php echo ";
echo "\$_GET['stockinsign']?>\">    <input type=\"hidden\" name=\"payamt\" value=\"";
echo "<?php echo ";
echo "\$_GET['payamt']?>\">    <input type=\"hidden\" name=\"chinaAmt\" value=\"";
echo "<?php echo ";
echo "\$_GET['chinaAmt']?>\">    <input type=\"hidden\" name=\"flag\">     </form>    <br>    <input type=\"button\" name=\"close\" id=\"close\" class=\"SmallButton\" value=\"保存\" onClick=\"javascript:stockBack('";
echo "<?php echo ";
echo "sizeof(\$rs_a)?>');\">    <input type=\"button\" name=\"close\" id=\"close\" class=\"SmallButton\" value=\"关闭\" onClick=\"javascript:parent.window.close();\">    </body>    </html>        ";
echo "<s";
echo "cript>     document.all(\"pimg\").style.display=\"none\";     document.all(\"abc\").style.display=\"none\";      document.all(\"pinghead\").style.display=\"none\";    </script> ";
?>
